2025-06-07 19:13:27,151 - INFO - üöÄ Loading model: meta-llama/Llama-3.2-3B
2025-06-07 19:13:27,381 - INFO - ‚úÖ HF authentication successful
2025-06-07 19:13:30,010 - INFO - Tokenizer loaded - vocab_size: 128256
2025-06-07 19:13:30,828 - INFO - ‚úÖ Fixed ALL_PARALLEL_STYLES
2025-06-07 19:13:31,244 - ERROR - Model loading failed: Using a `device_map`, `tp_plan`, `torch.device` context manager or setting `torch.set_default_device(device)` requires `accelerate`. You can install it with `pip install accelerate`
2025-06-07 19:13:57,709 - INFO - ‚úÖ Model loaded with minimal method (float32)
2025-06-07 19:13:57,712 - INFO - ‚úÖ Model loaded - 3,212,749,824 parameters
2025-06-07 19:13:57,712 - INFO -    GPU: NVIDIA A100-SXM4-80GB - 79.3GB VRAM
2025-06-07 19:13:57,713 - INFO - üìÅ Loading labeled dataset: /root/codexglue_merged_label.json
2025-06-07 19:13:59,671 - INFO - ‚úÖ Loaded 100000 samples
2025-06-07 19:13:59,676 - INFO - üìä Dataset composition:
2025-06-07 19:13:59,676 - INFO -    Meta samples: 10000 (10.0%)
2025-06-07 19:13:59,676 - INFO -    SFT samples: 90000 (90.0%)
2025-06-07 19:13:59,714 - INFO - 
üìä Train/Val Split:
2025-06-07 19:13:59,714 - INFO - üöÇ TRAIN SET: 90000 samples
2025-06-07 19:13:59,714 - INFO -    ‚Ä¢ Meta: 9000 (10.0%)
2025-06-07 19:13:59,714 - INFO -    ‚Ä¢ SFT: 81000 (90.0%)
2025-06-07 19:13:59,714 - INFO - üß™ VALIDATION SET: 10000 samples
2025-06-07 19:13:59,714 - INFO -    ‚Ä¢ Meta: 1000 (10.0%)
2025-06-07 19:13:59,714 - INFO -    ‚Ä¢ SFT: 9000 (90.0%)
2025-06-07 19:13:59,714 - INFO - 
üîç Validation Set Examples:
2025-06-07 19:13:59,714 - INFO - Meta examples (first 3):
2025-06-07 19:13:59,714 - INFO -   [0] ID: 19153, Label: meta
2025-06-07 19:13:59,714 - INFO -   [1] ID: 33675, Label: meta
2025-06-07 19:13:59,714 - INFO -   [2] ID: 36568, Label: meta
2025-06-07 19:13:59,714 - INFO - SFT examples (first 3):
2025-06-07 19:13:59,714 - INFO -   [0] ID: 31802, Label: sft
2025-06-07 19:13:59,714 - INFO -   [1] ID: 11084, Label: sft
2025-06-07 19:13:59,714 - INFO -   [2] ID: 34433, Label: sft
2025-06-07 19:13:59,714 - INFO - üéØ Creating Simple Dataset:
2025-06-07 19:13:59,714 - INFO -    Total samples: 90000
2025-06-07 19:13:59,732 - INFO -    Meta samples: 9000 (10.0%)
2025-06-07 19:13:59,732 - INFO -    SFT samples: 81000 (90.0%)
2025-06-07 19:13:59,732 - INFO - üî• PRE-TOKENIZING ALL SAMPLES...
2025-06-07 19:14:46,863 - INFO - ‚úÖ Tokenization complete: 90000 entries
2025-06-07 19:14:46,863 - INFO - üéØ Creating Simple Dataset:
2025-06-07 19:14:46,863 - INFO -    Total samples: 10000
2025-06-07 19:14:46,866 - INFO -    Meta samples: 1000 (10.0%)
2025-06-07 19:14:46,866 - INFO -    SFT samples: 9000 (90.0%)
2025-06-07 19:14:46,866 - INFO - üî• PRE-TOKENIZING ALL SAMPLES...
2025-06-07 19:14:52,170 - INFO - ‚úÖ Tokenization complete: 10000 entries
2025-06-07 19:14:52,173 - INFO - üéØ Optimizer setup:
2025-06-07 19:14:52,173 - INFO -    Steps per epoch: 1875
2025-06-07 19:14:52,173 - INFO -    Total steps: 5625
2025-06-07 19:14:52,174 - INFO -    Warmup steps: 168
2025-06-07 19:14:52,174 - INFO -    Eval frequency: every 375 steps (5x per epoch)
2025-06-07 19:14:52,174 - INFO - üöÄ Starting SIMPLE training...
2025-06-07 19:14:52,174 - INFO -    üìä Dataset: 100K samples (10% meta, 90% SFT)
2025-06-07 19:14:52,174 - INFO -    üéØ Each sample appears exactly once per epoch
2025-06-07 19:14:52,174 - INFO -    üîß Dual early stopping (patience=3)
2025-06-07 19:14:52,174 - INFO -    üìà 5 evaluations per epoch
2025-06-07 19:14:52,174 - INFO -    üíæ Best model saved based on average validation loss
2025-06-07 19:14:52,174 - INFO - 
üéØ EPOCH 1/3
2025-06-07 19:16:21,817 - INFO - üöÄ Step   10 | SFT: 2.6011 | Meta: 2.3569 | LR: 1.19e-06
2025-06-07 19:16:21,818 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-07 19:17:56,992 - INFO - üöÄ Step   20 | SFT: 1.4206 | Meta: 2.1360 | LR: 2.38e-06
2025-06-07 19:17:56,993 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-07 19:19:37,428 - INFO - üöÄ Step   30 | SFT: 1.2129 | Meta: 1.8171 | LR: 3.57e-06
2025-06-07 19:19:37,428 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-07 19:21:09,767 - INFO - üöÄ Step   40 | SFT: 1.1314 | Meta: 1.6113 | LR: 4.76e-06
2025-06-07 19:21:09,767 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-07 19:22:36,060 - INFO - üöÄ Step   50 | SFT: 1.0819 | Meta: 1.4838 | LR: 5.95e-06
2025-06-07 19:22:36,061 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-07 19:24:14,116 - INFO - üöÄ Step   60 | SFT: 1.0644 | Meta: 1.1591 | LR: 7.14e-06
2025-06-07 19:24:14,117 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-07 19:25:43,572 - INFO - üöÄ Step   70 | SFT: 0.9942 | Meta: 0.9216 | LR: 8.33e-06
2025-06-07 19:25:43,573 - INFO -    GPU: 35.9GB/79.3GB (45.4%)
2025-06-07 19:27:14,617 - INFO - üöÄ Step   80 | SFT: 1.0579 | Meta: 0.8322 | LR: 9.52e-06
2025-06-07 19:27:14,618 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-07 19:28:41,944 - INFO - üöÄ Step   90 | SFT: 0.9950 | Meta: 0.7981 | LR: 1.07e-05
2025-06-07 19:28:41,945 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-07 19:30:15,551 - INFO - üöÄ Step  100 | SFT: 1.0621 | Meta: 0.7867 | LR: 1.19e-05
2025-06-07 19:30:15,551 - INFO -    GPU: 35.9GB/79.3GB (45.4%)
2025-06-07 19:31:43,489 - INFO - üöÄ Step  110 | SFT: 0.9979 | Meta: 0.7743 | LR: 1.31e-05
2025-06-07 19:31:43,489 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-07 19:33:17,109 - INFO - üöÄ Step  120 | SFT: 1.0329 | Meta: 0.7630 | LR: 1.43e-05
2025-06-07 19:33:17,110 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-07 19:34:51,526 - INFO - üöÄ Step  130 | SFT: 1.0494 | Meta: 0.7576 | LR: 1.55e-05
2025-06-07 19:34:51,526 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-07 19:36:25,542 - INFO - üöÄ Step  140 | SFT: 1.0550 | Meta: 0.7514 | LR: 1.67e-05
2025-06-07 19:36:25,542 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-07 19:38:01,574 - INFO - üöÄ Step  150 | SFT: 0.9879 | Meta: 0.7364 | LR: 1.79e-05
2025-06-07 19:38:01,574 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-07 19:39:32,156 - INFO - üöÄ Step  160 | SFT: 0.9887 | Meta: 0.7332 | LR: 1.90e-05
2025-06-07 19:39:32,156 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-07 19:41:03,913 - INFO - üöÄ Step  170 | SFT: 0.9880 | Meta: 0.7352 | LR: 2.00e-05
2025-06-07 19:41:03,913 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-07 19:42:28,126 - INFO - üöÄ Step  180 | SFT: 1.0080 | Meta: 0.7316 | LR: 2.00e-05
2025-06-07 19:42:28,127 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-07 19:44:04,647 - INFO - üöÄ Step  190 | SFT: 1.0041 | Meta: 0.7309 | LR: 2.00e-05
2025-06-07 19:44:04,647 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-07 19:45:27,714 - INFO - üöÄ Step  200 | SFT: 0.9920 | Meta: 0.7310 | LR: 2.00e-05
2025-06-07 19:45:27,714 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-07 19:46:52,901 - INFO - üöÄ Step  210 | SFT: 0.9465 | Meta: 0.7292 | LR: 2.00e-05
2025-06-07 19:46:52,901 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-07 19:48:12,902 - INFO - üöÄ Step  220 | SFT: 0.9788 | Meta: 0.7167 | LR: 2.00e-05
2025-06-07 19:48:12,902 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-07 19:49:51,617 - INFO - üöÄ Step  230 | SFT: 0.9964 | Meta: 0.7154 | LR: 2.00e-05
2025-06-07 19:49:51,617 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-07 19:51:25,282 - INFO - üöÄ Step  240 | SFT: 0.9569 | Meta: 0.7102 | LR: 2.00e-05
2025-06-07 19:51:25,282 - INFO -    GPU: 35.9GB/79.3GB (45.4%)
2025-06-07 19:52:52,485 - INFO - üöÄ Step  250 | SFT: 0.9262 | Meta: 0.7020 | LR: 2.00e-05
2025-06-07 19:52:52,485 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-07 19:54:17,505 - ERROR - Critical error in enhanced loss computation: CUDA out of memory. Tried to allocate 1.57 GiB. GPU 0 has a total capacity of 79.25 GiB of which 224.94 MiB is free. Process 3174301 has 79.02 GiB memory in use. Of the allocated memory 77.75 GiB is allocated by PyTorch, and 798.83 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-06-07 19:54:26,269 - INFO - üöÄ Step  260 | SFT: 0.9308 | Meta: 0.6922 | LR: 2.00e-05
2025-06-07 19:54:26,269 - INFO -    GPU: 35.9GB/79.3GB (45.4%)
2025-06-07 19:56:04,799 - INFO - üöÄ Step  270 | SFT: 0.9643 | Meta: 0.6958 | LR: 2.00e-05
2025-06-07 19:56:04,799 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-07 19:57:36,094 - INFO - üöÄ Step  280 | SFT: 0.9686 | Meta: 0.6875 | LR: 2.00e-05
2025-06-07 19:57:36,095 - INFO -    GPU: 35.9GB/79.3GB (45.4%)
2025-06-07 19:59:07,024 - INFO - üöÄ Step  290 | SFT: 0.9345 | Meta: 0.6809 | LR: 2.00e-05
2025-06-07 19:59:07,024 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-07 20:00:38,577 - INFO - üöÄ Step  300 | SFT: 0.9674 | Meta: 0.6736 | LR: 2.00e-05
2025-06-07 20:00:38,577 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-07 20:02:09,761 - INFO - üöÄ Step  310 | SFT: 0.9308 | Meta: 0.6662 | LR: 2.00e-05
2025-06-07 20:02:09,762 - INFO -    GPU: 35.9GB/79.3GB (45.4%)
2025-06-07 20:03:43,786 - INFO - üöÄ Step  320 | SFT: 0.9261 | Meta: 0.6577 | LR: 2.00e-05
2025-06-07 20:03:43,787 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-07 20:05:22,633 - INFO - üöÄ Step  330 | SFT: 0.9112 | Meta: 0.6511 | LR: 2.00e-05
2025-06-07 20:05:22,633 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-07 20:06:52,278 - INFO - üöÄ Step  340 | SFT: 0.9116 | Meta: 0.6529 | LR: 2.00e-05
2025-06-07 20:06:52,279 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-07 20:08:29,883 - INFO - üöÄ Step  350 | SFT: 0.9212 | Meta: 0.6569 | LR: 1.99e-05
2025-06-07 20:08:29,883 - INFO -    GPU: 35.9GB/79.3GB (45.4%)
2025-06-07 20:09:59,642 - INFO - üöÄ Step  360 | SFT: 0.9285 | Meta: 0.6616 | LR: 1.99e-05
2025-06-07 20:09:59,642 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-07 20:11:28,040 - INFO - üöÄ Step  370 | SFT: 0.8905 | Meta: 0.6617 | LR: 1.99e-05
2025-06-07 20:11:28,040 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-07 20:17:48,278 - INFO - 
============================================================
2025-06-07 20:17:48,278 - INFO - üìä VALIDATION 1/5 - Epoch 1, Step 375
2025-06-07 20:17:48,278 - INFO - ============================================================
2025-06-07 20:17:48,278 - INFO -   ‚Ä¢ SFT Loss: 0.9139 (9000 samples)
2025-06-07 20:17:48,278 - INFO -   ‚Ä¢ Meta Loss: 0.6456 (1000 samples)
2025-06-07 20:17:48,278 - INFO -   ‚Ä¢ Average Loss: 0.9077
2025-06-07 20:17:48,278 - INFO -   ‚Ä¢ Meta-SFT Gap: -0.2683
2025-06-07 20:17:59,832 - INFO - ‚úÖ New best model saved in memory
2025-06-07 20:17:59,833 - INFO -   ‚Ä¢ Early Stop: SFT 0/3 | Meta 0/3
2025-06-07 20:17:59,833 - INFO -   ‚Ä¢ Best Avg: 0.9077 (epoch 0, step 375)
2025-06-07 20:17:59,833 - INFO - ============================================================

2025-06-07 20:17:59,833 - INFO - üèÜ New best model! Saving...
2025-06-07 20:17:59,833 - INFO - üíæ Attempting to save model to: /root/llama3.2-3b-training/best/model
2025-06-07 20:17:59,834 - INFO -    Trying standard safe save...
2025-06-07 20:17:59,838 - WARNING -    Standard safe save failed: cannot import name 'DTensor' from 'torch.distributed.tensor' (/usr/local/lib/python3.11/dist-packages/torch/distributed/tensor/__init__.py)
2025-06-07 20:17:59,838 - INFO -    Trying without safe serialization...
2025-06-07 20:17:59,866 - WARNING -    Non-safe save failed: name 'DTensor' is not defined
2025-06-07 20:17:59,866 - INFO -    Trying manual state dict save...
2025-06-07 20:18:13,384 - INFO - ‚úÖ Manual save successful!
2025-06-07 20:18:59,190 - INFO - üíæ Checkpoint saved: /root/llama3.2-3b-training/checkpoints/checkpoint-best.pt
2025-06-07 20:19:42,427 - INFO - üöÄ Step  380 | SFT: 0.9221 | Meta: 0.6633 | LR: 1.99e-05
2025-06-07 20:19:42,427 - INFO -    GPU: 35.9GB/79.3GB (45.4%)
2025-06-07 20:21:22,111 - INFO - üöÄ Step  390 | SFT: 0.9296 | Meta: 0.6697 | LR: 1.99e-05
2025-06-07 20:21:22,111 - INFO -    GPU: 36.0GB/79.3GB (45.4%)
2025-06-07 20:22:54,479 - INFO - üöÄ Step  400 | SFT: 0.9143 | Meta: 0.6616 | LR: 1.99e-05
2025-06-07 20:22:54,479 - INFO -    GPU: 36.0GB/79.3GB (45.4%)
2025-06-07 20:24:25,140 - INFO - üöÄ Step  410 | SFT: 0.8709 | Meta: 0.6549 | LR: 1.99e-05
2025-06-07 20:24:25,140 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-07 20:26:07,000 - INFO - üöÄ Step  420 | SFT: 0.9269 | Meta: 0.6537 | LR: 1.99e-05
2025-06-07 20:26:07,000 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-07 20:27:29,466 - INFO - üöÄ Step  430 | SFT: 0.8962 | Meta: 0.6536 | LR: 1.99e-05
2025-06-07 20:27:29,467 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-07 20:29:10,365 - INFO - üöÄ Step  440 | SFT: 0.8636 | Meta: 0.6509 | LR: 1.99e-05
2025-06-07 20:29:10,365 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-07 20:30:44,625 - INFO - üöÄ Step  450 | SFT: 0.8859 | Meta: 0.6548 | LR: 1.99e-05
2025-06-07 20:30:44,625 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-07 20:32:10,804 - INFO - üöÄ Step  460 | SFT: 0.9223 | Meta: 0.6482 | LR: 1.99e-05
2025-06-07 20:32:10,805 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-07 20:33:43,334 - INFO - üöÄ Step  470 | SFT: 0.9218 | Meta: 0.6404 | LR: 1.98e-05
2025-06-07 20:33:43,334 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-07 20:35:14,657 - INFO - üöÄ Step  480 | SFT: 0.9167 | Meta: 0.6325 | LR: 1.98e-05
2025-06-07 20:35:14,657 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-07 20:36:50,500 - INFO - üöÄ Step  490 | SFT: 0.8997 | Meta: 0.6326 | LR: 1.98e-05
2025-06-07 20:36:50,500 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-07 20:38:24,109 - INFO - üöÄ Step  500 | SFT: 0.8697 | Meta: 0.6245 | LR: 1.98e-05
2025-06-07 20:38:24,109 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-07 20:40:04,132 - INFO - üöÄ Step  510 | SFT: 0.8633 | Meta: 0.6212 | LR: 1.98e-05
2025-06-07 20:40:04,133 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-07 20:41:34,142 - INFO - üöÄ Step  520 | SFT: 0.8847 | Meta: 0.6174 | LR: 1.98e-05
2025-06-07 20:41:34,142 - INFO -    GPU: 36.0GB/79.3GB (45.4%)
2025-06-07 20:43:04,700 - INFO - üöÄ Step  530 | SFT: 0.8667 | Meta: 0.6151 | LR: 1.98e-05
2025-06-07 20:43:04,701 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-07 20:44:41,081 - INFO - üöÄ Step  540 | SFT: 0.8820 | Meta: 0.6070 | LR: 1.98e-05
2025-06-07 20:44:41,082 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-07 20:46:04,660 - INFO - üöÄ Step  550 | SFT: 0.8501 | Meta: 0.6108 | LR: 1.98e-05
2025-06-07 20:46:04,660 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-07 20:47:34,970 - INFO - üöÄ Step  560 | SFT: 0.8512 | Meta: 0.6120 | LR: 1.97e-05
2025-06-07 20:47:34,971 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-07 20:49:12,758 - INFO - üöÄ Step  570 | SFT: 0.8806 | Meta: 0.6189 | LR: 1.97e-05
2025-06-07 20:49:12,758 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-07 20:50:42,861 - INFO - üöÄ Step  580 | SFT: 0.8676 | Meta: 0.6153 | LR: 1.97e-05
2025-06-07 20:50:42,861 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-07 20:52:23,484 - INFO - üöÄ Step  590 | SFT: 0.8865 | Meta: 0.6077 | LR: 1.97e-05
2025-06-07 20:52:23,485 - INFO -    GPU: 35.9GB/79.3GB (45.4%)
2025-06-07 20:53:50,619 - INFO - üöÄ Step  600 | SFT: 0.9150 | Meta: 0.5970 | LR: 1.97e-05
2025-06-07 20:53:50,619 - INFO -    GPU: 35.9GB/79.3GB (45.4%)
2025-06-07 20:55:21,990 - INFO - üöÄ Step  610 | SFT: 0.8231 | Meta: 0.5965 | LR: 1.97e-05
2025-06-07 20:55:21,990 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-07 20:57:02,570 - INFO - üöÄ Step  620 | SFT: 0.8430 | Meta: 0.5907 | LR: 1.97e-05
2025-06-07 20:57:02,571 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-07 20:58:29,155 - INFO - üöÄ Step  630 | SFT: 0.8100 | Meta: 0.5964 | LR: 1.96e-05
2025-06-07 20:58:29,156 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-07 20:59:58,107 - INFO - üöÄ Step  640 | SFT: 0.8135 | Meta: 0.5935 | LR: 1.96e-05
2025-06-07 20:59:58,108 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-07 21:01:33,217 - INFO - üöÄ Step  650 | SFT: 0.8468 | Meta: 0.6017 | LR: 1.96e-05
2025-06-07 21:01:33,218 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-07 21:02:57,830 - INFO - üöÄ Step  660 | SFT: 0.8326 | Meta: 0.6028 | LR: 1.96e-05
2025-06-07 21:02:57,831 - INFO -    GPU: 35.9GB/79.3GB (45.4%)
2025-06-07 21:04:25,346 - INFO - üöÄ Step  670 | SFT: 0.8407 | Meta: 0.5974 | LR: 1.96e-05
2025-06-07 21:04:25,346 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-07 21:06:02,391 - INFO - üöÄ Step  680 | SFT: 0.8327 | Meta: 0.5977 | LR: 1.96e-05
2025-06-07 21:06:02,391 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-07 21:07:42,221 - INFO - üöÄ Step  690 | SFT: 0.8818 | Meta: 0.5900 | LR: 1.96e-05
2025-06-07 21:07:42,222 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-07 21:09:21,899 - INFO - üöÄ Step  700 | SFT: 0.7916 | Meta: 0.5790 | LR: 1.95e-05
2025-06-07 21:09:21,899 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-07 21:10:46,282 - INFO - üöÄ Step  710 | SFT: 0.8305 | Meta: 0.5759 | LR: 1.95e-05
2025-06-07 21:10:46,282 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-07 21:12:22,994 - INFO - üöÄ Step  720 | SFT: 0.8213 | Meta: 0.5666 | LR: 1.95e-05
2025-06-07 21:12:22,994 - INFO -    GPU: 35.9GB/79.3GB (45.4%)
2025-06-07 21:13:58,967 - INFO - üöÄ Step  730 | SFT: 0.8328 | Meta: 0.5672 | LR: 1.95e-05
2025-06-07 21:13:58,968 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-07 21:15:33,475 - INFO - üöÄ Step  740 | SFT: 0.8142 | Meta: 0.5795 | LR: 1.95e-05
2025-06-07 21:15:33,475 - INFO -    GPU: 35.9GB/79.3GB (45.4%)
2025-06-07 21:22:37,862 - INFO - 
============================================================
2025-06-07 21:22:37,863 - INFO - üìä VALIDATION 2/5 - Epoch 1, Step 750
2025-06-07 21:22:37,863 - INFO - ============================================================
2025-06-07 21:22:37,863 - INFO -   ‚Ä¢ SFT Loss: 0.8265 (9000 samples)
2025-06-07 21:22:37,863 - INFO -   ‚Ä¢ Meta Loss: 0.5799 (1000 samples)
2025-06-07 21:22:37,863 - INFO -   ‚Ä¢ Average Loss: 0.8168
2025-06-07 21:22:37,863 - INFO -   ‚Ä¢ Meta-SFT Gap: -0.2465
2025-06-07 21:22:56,763 - INFO - ‚úÖ New best model saved in memory
2025-06-07 21:22:56,763 - INFO -   ‚Ä¢ Early Stop: SFT 0/3 | Meta 0/3
2025-06-07 21:22:56,764 - INFO -   ‚Ä¢ Best Avg: 0.8168 (epoch 0, step 750)
2025-06-07 21:22:56,764 - INFO - ============================================================

2025-06-07 21:22:56,765 - INFO - üèÜ New best model! Saving...
2025-06-07 21:22:56,765 - INFO - üíæ Attempting to save model to: /root/llama3.2-3b-training/best/model
2025-06-07 21:22:56,765 - INFO -    Trying standard safe save...
2025-06-07 21:22:56,769 - WARNING -    Standard safe save failed: cannot import name 'DTensor' from 'torch.distributed.tensor' (/usr/local/lib/python3.11/dist-packages/torch/distributed/tensor/__init__.py)
2025-06-07 21:22:56,769 - INFO -    Trying without safe serialization...
2025-06-07 21:22:56,790 - WARNING -    Non-safe save failed: name 'DTensor' is not defined
2025-06-07 21:22:56,790 - INFO -    Trying manual state dict save...
2025-06-07 21:23:14,841 - INFO - ‚úÖ Manual save successful!
2025-06-07 21:24:03,020 - INFO - üíæ Checkpoint saved: /root/llama3.2-3b-training/checkpoints/checkpoint-best.pt
2025-06-07 21:24:03,022 - INFO - üöÄ Step  750 | SFT: 0.8470 | Meta: 0.5896 | LR: 1.94e-05
2025-06-07 21:24:03,022 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-07 21:25:26,043 - INFO - üöÄ Step  760 | SFT: 0.8026 | Meta: 0.5883 | LR: 1.94e-05
2025-06-07 21:25:26,044 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-07 21:26:55,646 - INFO - üöÄ Step  770 | SFT: 0.8333 | Meta: 0.5788 | LR: 1.94e-05
2025-06-07 21:26:55,647 - INFO -    GPU: 36.0GB/79.3GB (45.4%)
2025-06-07 21:28:27,241 - INFO - üöÄ Step  780 | SFT: 0.8203 | Meta: 0.5765 | LR: 1.94e-05
2025-06-07 21:28:27,242 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-07 21:30:15,374 - INFO - üöÄ Step  790 | SFT: 0.8360 | Meta: 0.5714 | LR: 1.94e-05
2025-06-07 21:30:15,374 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-07 21:31:49,674 - INFO - üöÄ Step  800 | SFT: 0.8454 | Meta: 0.5709 | LR: 1.93e-05
2025-06-07 21:31:49,675 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-07 21:33:20,925 - INFO - üöÄ Step  810 | SFT: 0.8519 | Meta: 0.5665 | LR: 1.93e-05
2025-06-07 21:33:20,925 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-07 21:34:52,325 - INFO - üöÄ Step  820 | SFT: 0.7769 | Meta: 0.5727 | LR: 1.93e-05
2025-06-07 21:34:52,325 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-07 21:36:25,945 - INFO - üöÄ Step  830 | SFT: 0.8612 | Meta: 0.5792 | LR: 1.93e-05
2025-06-07 21:36:25,945 - INFO -    GPU: 35.9GB/79.3GB (45.4%)
2025-06-07 21:37:46,433 - ERROR - Critical error in enhanced loss computation: CUDA out of memory. Tried to allocate 1.57 GiB. GPU 0 has a total capacity of 79.25 GiB of which 146.94 MiB is free. Process 3174301 has 79.10 GiB memory in use. Of the allocated memory 77.81 GiB is allocated by PyTorch, and 813.68 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-06-07 21:38:02,333 - INFO - üöÄ Step  840 | SFT: 0.8228 | Meta: 0.5854 | LR: 1.93e-05
2025-06-07 21:38:02,334 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-07 21:39:28,888 - INFO - üöÄ Step  850 | SFT: 0.8436 | Meta: 0.5853 | LR: 1.92e-05
2025-06-07 21:39:28,888 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-07 21:41:05,903 - INFO - üöÄ Step  860 | SFT: 0.7822 | Meta: 0.5839 | LR: 1.92e-05
2025-06-07 21:41:05,903 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-07 21:42:34,792 - INFO - üöÄ Step  870 | SFT: 0.8470 | Meta: 0.5770 | LR: 1.92e-05
2025-06-07 21:42:34,792 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-07 21:44:16,122 - INFO - üöÄ Step  880 | SFT: 0.8077 | Meta: 0.5777 | LR: 1.92e-05
2025-06-07 21:44:16,122 - INFO -    GPU: 35.9GB/79.3GB (45.4%)
2025-06-07 21:45:44,564 - INFO - üöÄ Step  890 | SFT: 0.7943 | Meta: 0.5739 | LR: 1.91e-05
2025-06-07 21:45:44,565 - INFO -    GPU: 35.9GB/79.3GB (45.4%)
2025-06-07 21:47:24,626 - INFO - üöÄ Step  900 | SFT: 0.7862 | Meta: 0.5641 | LR: 1.91e-05
2025-06-07 21:47:24,627 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-07 21:48:56,972 - INFO - üöÄ Step  910 | SFT: 0.8251 | Meta: 0.5626 | LR: 1.91e-05
2025-06-07 21:48:56,972 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-07 21:50:38,153 - INFO - üöÄ Step  920 | SFT: 0.8047 | Meta: 0.5662 | LR: 1.91e-05
2025-06-07 21:50:38,153 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-07 21:52:06,527 - INFO - üöÄ Step  930 | SFT: 0.7957 | Meta: 0.5625 | LR: 1.91e-05
2025-06-07 21:52:06,528 - INFO -    GPU: 35.9GB/79.3GB (45.4%)
2025-06-07 21:53:41,374 - INFO - üöÄ Step  940 | SFT: 0.8008 | Meta: 0.5613 | LR: 1.90e-05
2025-06-07 21:53:41,374 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-07 21:55:18,755 - INFO - üöÄ Step  950 | SFT: 0.8130 | Meta: 0.5648 | LR: 1.90e-05
2025-06-07 21:55:18,755 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-07 21:56:52,981 - INFO - üöÄ Step  960 | SFT: 0.8261 | Meta: 0.5556 | LR: 1.90e-05
2025-06-07 21:56:52,981 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-07 21:58:23,676 - INFO - üöÄ Step  970 | SFT: 0.7951 | Meta: 0.5559 | LR: 1.90e-05
2025-06-07 21:58:23,676 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-07 21:59:49,225 - INFO - üöÄ Step  980 | SFT: 0.8065 | Meta: 0.5578 | LR: 1.89e-05
2025-06-07 21:59:49,226 - INFO -    GPU: 35.9GB/79.3GB (45.4%)
2025-06-07 22:01:30,904 - INFO - üöÄ Step  990 | SFT: 0.8047 | Meta: 0.5558 | LR: 1.89e-05
2025-06-07 22:01:30,904 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-07 22:03:15,113 - INFO - üöÄ Step 1000 | SFT: 0.7078 | Meta: 0.5597 | LR: 1.89e-05
2025-06-07 22:03:15,113 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-07 22:04:48,754 - INFO - üöÄ Step 1010 | SFT: 0.7804 | Meta: 0.5708 | LR: 1.88e-05
2025-06-07 22:04:48,755 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-07 22:06:22,610 - INFO - üöÄ Step 1020 | SFT: 0.8143 | Meta: 0.5612 | LR: 1.88e-05
2025-06-07 22:06:22,610 - INFO -    GPU: 35.9GB/79.3GB (45.4%)
2025-06-07 22:07:54,929 - INFO - üöÄ Step 1030 | SFT: 0.8470 | Meta: 0.5601 | LR: 1.88e-05
2025-06-07 22:07:54,929 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-07 22:09:32,855 - INFO - üöÄ Step 1040 | SFT: 0.7908 | Meta: 0.5643 | LR: 1.88e-05
2025-06-07 22:09:32,855 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-07 22:10:57,146 - INFO - üöÄ Step 1050 | SFT: 0.7398 | Meta: 0.5652 | LR: 1.87e-05
2025-06-07 22:10:57,146 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-07 22:12:32,257 - INFO - üöÄ Step 1060 | SFT: 0.7322 | Meta: 0.5462 | LR: 1.87e-05
2025-06-07 22:12:32,258 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-07 22:13:57,175 - INFO - üöÄ Step 1070 | SFT: 0.8278 | Meta: 0.5547 | LR: 1.87e-05
2025-06-07 22:13:57,176 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-07 22:15:30,777 - INFO - üöÄ Step 1080 | SFT: 0.7764 | Meta: 0.5590 | LR: 1.87e-05
2025-06-07 22:15:30,777 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-07 22:17:01,922 - INFO - üöÄ Step 1090 | SFT: 0.7415 | Meta: 0.5523 | LR: 1.86e-05
2025-06-07 22:17:01,922 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-07 22:18:31,964 - INFO - üöÄ Step 1100 | SFT: 0.7560 | Meta: 0.5364 | LR: 1.86e-05
2025-06-07 22:18:31,964 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-07 22:20:01,172 - INFO - üöÄ Step 1110 | SFT: 0.7807 | Meta: 0.5345 | LR: 1.86e-05
2025-06-07 22:20:01,172 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-07 22:21:38,736 - INFO - üöÄ Step 1120 | SFT: 0.8287 | Meta: 0.5387 | LR: 1.85e-05
2025-06-07 22:21:38,737 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-07 22:27:53,499 - INFO - 
============================================================
2025-06-07 22:27:53,500 - INFO - üìä VALIDATION 3/5 - Epoch 1, Step 1125
2025-06-07 22:27:53,500 - INFO - ============================================================
2025-06-07 22:27:53,500 - INFO -   ‚Ä¢ SFT Loss: 0.7686 (9000 samples)
2025-06-07 22:27:53,500 - INFO -   ‚Ä¢ Meta Loss: 0.5396 (1000 samples)
2025-06-07 22:27:53,500 - INFO -   ‚Ä¢ Average Loss: 0.7551
2025-06-07 22:27:53,500 - INFO -   ‚Ä¢ Meta-SFT Gap: -0.2290
2025-06-07 22:28:11,420 - INFO - ‚úÖ New best model saved in memory
2025-06-07 22:28:11,421 - INFO -   ‚Ä¢ Early Stop: SFT 0/3 | Meta 0/3
2025-06-07 22:28:11,421 - INFO -   ‚Ä¢ Best Avg: 0.7551 (epoch 0, step 1125)
2025-06-07 22:28:11,421 - INFO - ============================================================

2025-06-07 22:28:11,422 - INFO - üèÜ New best model! Saving...
2025-06-07 22:28:11,422 - INFO - üíæ Attempting to save model to: /root/llama3.2-3b-training/best/model
2025-06-07 22:28:11,422 - INFO -    Trying standard safe save...
2025-06-07 22:28:11,427 - WARNING -    Standard safe save failed: cannot import name 'DTensor' from 'torch.distributed.tensor' (/usr/local/lib/python3.11/dist-packages/torch/distributed/tensor/__init__.py)
2025-06-07 22:28:11,427 - INFO -    Trying without safe serialization...
2025-06-07 22:28:11,454 - WARNING -    Non-safe save failed: name 'DTensor' is not defined
2025-06-07 22:28:11,454 - INFO -    Trying manual state dict save...
2025-06-07 22:28:28,108 - INFO - ‚úÖ Manual save successful!
2025-06-07 22:29:14,067 - INFO - üíæ Checkpoint saved: /root/llama3.2-3b-training/checkpoints/checkpoint-best.pt
2025-06-07 22:29:59,373 - INFO - üöÄ Step 1130 | SFT: 0.7541 | Meta: 0.5329 | LR: 1.85e-05
2025-06-07 22:29:59,373 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-07 22:31:30,507 - INFO - üöÄ Step 1140 | SFT: 0.7755 | Meta: 0.5316 | LR: 1.85e-05
2025-06-07 22:31:30,507 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-07 22:32:56,569 - INFO - üöÄ Step 1150 | SFT: 0.8088 | Meta: 0.5319 | LR: 1.84e-05
2025-06-07 22:32:56,570 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-07 22:34:34,735 - INFO - üöÄ Step 1160 | SFT: 0.7035 | Meta: 0.5428 | LR: 1.84e-05
2025-06-07 22:34:34,735 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-07 22:35:59,117 - INFO - üöÄ Step 1170 | SFT: 0.8197 | Meta: 0.5408 | LR: 1.84e-05
2025-06-07 22:35:59,117 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-07 22:37:26,953 - INFO - üöÄ Step 1180 | SFT: 0.7951 | Meta: 0.5361 | LR: 1.84e-05
2025-06-07 22:37:26,953 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-07 22:38:51,526 - INFO - üöÄ Step 1190 | SFT: 0.7741 | Meta: 0.5376 | LR: 1.83e-05
2025-06-07 22:38:51,526 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-07 22:40:17,964 - INFO - üöÄ Step 1200 | SFT: 0.7989 | Meta: 0.5418 | LR: 1.83e-05
2025-06-07 22:40:17,964 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-07 22:41:45,985 - INFO - üöÄ Step 1210 | SFT: 0.7712 | Meta: 0.5363 | LR: 1.83e-05
2025-06-07 22:41:45,985 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-07 22:43:22,864 - INFO - üöÄ Step 1220 | SFT: 0.7224 | Meta: 0.5357 | LR: 1.82e-05
2025-06-07 22:43:22,864 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-07 22:44:53,113 - INFO - üöÄ Step 1230 | SFT: 0.7252 | Meta: 0.5342 | LR: 1.82e-05
2025-06-07 22:44:53,114 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-07 22:46:29,815 - INFO - üöÄ Step 1240 | SFT: 0.7613 | Meta: 0.5314 | LR: 1.82e-05
2025-06-07 22:46:29,815 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-07 22:48:06,834 - INFO - üöÄ Step 1250 | SFT: 0.8111 | Meta: 0.5364 | LR: 1.81e-05
2025-06-07 22:48:06,834 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-07 22:49:40,951 - INFO - üöÄ Step 1260 | SFT: 0.7541 | Meta: 0.5355 | LR: 1.81e-05
2025-06-07 22:49:40,951 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-07 22:51:12,232 - INFO - üöÄ Step 1270 | SFT: 0.7062 | Meta: 0.5388 | LR: 1.81e-05
2025-06-07 22:51:12,232 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-07 22:52:50,013 - INFO - üöÄ Step 1280 | SFT: 0.6972 | Meta: 0.5392 | LR: 1.80e-05
2025-06-07 22:52:50,013 - INFO -    GPU: 35.9GB/79.3GB (45.4%)
2025-06-07 22:54:18,746 - INFO - üöÄ Step 1290 | SFT: 0.7441 | Meta: 0.5376 | LR: 1.80e-05
2025-06-07 22:54:18,747 - INFO -    GPU: 35.9GB/79.3GB (45.4%)
2025-06-07 22:55:45,462 - INFO - üöÄ Step 1300 | SFT: 0.7506 | Meta: 0.5358 | LR: 1.80e-05
2025-06-07 22:55:45,462 - INFO -    GPU: 35.9GB/79.3GB (45.4%)
2025-06-07 22:57:13,252 - INFO - üöÄ Step 1310 | SFT: 0.7695 | Meta: 0.5354 | LR: 1.79e-05
2025-06-07 22:57:13,253 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-07 22:58:42,564 - INFO - üöÄ Step 1320 | SFT: 0.6937 | Meta: 0.5300 | LR: 1.79e-05
2025-06-07 22:58:42,564 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-07 23:00:16,840 - INFO - üöÄ Step 1330 | SFT: 0.7520 | Meta: 0.5275 | LR: 1.78e-05
2025-06-07 23:00:16,840 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-07 23:01:49,814 - INFO - üöÄ Step 1340 | SFT: 0.7417 | Meta: 0.5273 | LR: 1.78e-05
2025-06-07 23:01:49,814 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-07 23:03:20,634 - INFO - üöÄ Step 1350 | SFT: 0.7712 | Meta: 0.5222 | LR: 1.78e-05
2025-06-07 23:03:20,634 - INFO -    GPU: 35.9GB/79.3GB (45.4%)
2025-06-07 23:04:51,796 - INFO - üöÄ Step 1360 | SFT: 0.7424 | Meta: 0.5190 | LR: 1.77e-05
2025-06-07 23:04:51,796 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-07 23:06:30,595 - INFO - üöÄ Step 1370 | SFT: 0.7299 | Meta: 0.5277 | LR: 1.77e-05
2025-06-07 23:06:30,595 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-07 23:08:08,692 - INFO - üöÄ Step 1380 | SFT: 0.7751 | Meta: 0.5380 | LR: 1.77e-05
2025-06-07 23:08:08,693 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-07 23:09:45,760 - INFO - üöÄ Step 1390 | SFT: 0.7605 | Meta: 0.5412 | LR: 1.76e-05
2025-06-07 23:09:45,760 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-07 23:11:19,548 - INFO - üöÄ Step 1400 | SFT: 0.8156 | Meta: 0.5355 | LR: 1.76e-05
2025-06-07 23:11:19,548 - INFO -    GPU: 35.9GB/79.3GB (45.4%)
2025-06-07 23:12:54,132 - INFO - üöÄ Step 1410 | SFT: 0.6679 | Meta: 0.5350 | LR: 1.76e-05
2025-06-07 23:12:54,132 - INFO -    GPU: 35.9GB/79.3GB (45.4%)
2025-06-07 23:14:22,418 - INFO - üöÄ Step 1420 | SFT: 0.7702 | Meta: 0.5259 | LR: 1.75e-05
2025-06-07 23:14:22,419 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-07 23:15:59,488 - INFO - üöÄ Step 1430 | SFT: 0.6757 | Meta: 0.5123 | LR: 1.75e-05
2025-06-07 23:15:59,488 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-07 23:17:34,999 - INFO - üöÄ Step 1440 | SFT: 0.7419 | Meta: 0.5147 | LR: 1.74e-05
2025-06-07 23:17:35,000 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-07 23:19:11,181 - INFO - üöÄ Step 1450 | SFT: 0.7481 | Meta: 0.5122 | LR: 1.74e-05
2025-06-07 23:19:11,181 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-07 23:20:42,542 - INFO - üöÄ Step 1460 | SFT: 0.7187 | Meta: 0.5095 | LR: 1.74e-05
2025-06-07 23:20:42,543 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-07 23:22:12,328 - INFO - üöÄ Step 1470 | SFT: 0.7141 | Meta: 0.5216 | LR: 1.73e-05
2025-06-07 23:22:12,328 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-07 23:23:46,527 - INFO - üöÄ Step 1480 | SFT: 0.7779 | Meta: 0.5240 | LR: 1.73e-05
2025-06-07 23:23:46,527 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-07 23:25:24,653 - INFO - üöÄ Step 1490 | SFT: 0.7024 | Meta: 0.5162 | LR: 1.72e-05
2025-06-07 23:25:24,653 - INFO -    GPU: 35.9GB/79.3GB (45.4%)
2025-06-07 23:32:28,071 - INFO - 
============================================================
2025-06-07 23:32:28,072 - INFO - üìä VALIDATION 4/5 - Epoch 1, Step 1500
2025-06-07 23:32:28,072 - INFO - ============================================================
2025-06-07 23:32:28,072 - INFO -   ‚Ä¢ SFT Loss: 0.7224 (9000 samples)
2025-06-07 23:32:28,072 - INFO -   ‚Ä¢ Meta Loss: 0.5069 (1000 samples)
2025-06-07 23:32:28,072 - INFO -   ‚Ä¢ Average Loss: 0.7067
2025-06-07 23:32:28,072 - INFO -   ‚Ä¢ Meta-SFT Gap: -0.2155
2025-06-07 23:32:46,746 - INFO - ‚úÖ New best model saved in memory
2025-06-07 23:32:46,746 - INFO -   ‚Ä¢ Early Stop: SFT 0/3 | Meta 0/3
2025-06-07 23:32:46,746 - INFO -   ‚Ä¢ Best Avg: 0.7067 (epoch 0, step 1500)
2025-06-07 23:32:46,746 - INFO - ============================================================

2025-06-07 23:32:46,747 - INFO - üèÜ New best model! Saving...
2025-06-07 23:32:46,747 - INFO - üíæ Attempting to save model to: /root/llama3.2-3b-training/best/model
2025-06-07 23:32:46,748 - INFO -    Trying standard safe save...
2025-06-07 23:32:46,752 - WARNING -    Standard safe save failed: cannot import name 'DTensor' from 'torch.distributed.tensor' (/usr/local/lib/python3.11/dist-packages/torch/distributed/tensor/__init__.py)
2025-06-07 23:32:46,752 - INFO -    Trying without safe serialization...
2025-06-07 23:32:46,775 - WARNING -    Non-safe save failed: name 'DTensor' is not defined
2025-06-07 23:32:46,775 - INFO -    Trying manual state dict save...
2025-06-07 23:32:54,633 - INFO - ‚úÖ Manual save successful!
2025-06-07 23:33:18,816 - INFO - üíæ Checkpoint saved: /root/llama3.2-3b-training/checkpoints/checkpoint-best.pt
2025-06-07 23:33:18,818 - INFO - üöÄ Step 1500 | SFT: 0.7463 | Meta: 0.5129 | LR: 1.72e-05
2025-06-07 23:33:18,818 - INFO -    GPU: 35.9GB/79.3GB (45.4%)
2025-06-07 23:34:56,271 - INFO - üöÄ Step 1510 | SFT: 0.7242 | Meta: 0.5083 | LR: 1.72e-05
2025-06-07 23:34:56,271 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-07 23:36:34,713 - INFO - üöÄ Step 1520 | SFT: 0.7041 | Meta: 0.5074 | LR: 1.71e-05
2025-06-07 23:36:34,714 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-07 23:38:08,434 - INFO - üöÄ Step 1530 | SFT: 0.7083 | Meta: 0.5056 | LR: 1.71e-05
2025-06-07 23:38:08,434 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-07 23:39:48,022 - INFO - üöÄ Step 1540 | SFT: 0.7045 | Meta: 0.4971 | LR: 1.70e-05
2025-06-07 23:39:48,022 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-07 23:41:23,470 - INFO - üöÄ Step 1550 | SFT: 0.6517 | Meta: 0.5015 | LR: 1.70e-05
2025-06-07 23:41:23,471 - INFO -    GPU: 35.9GB/79.3GB (45.4%)
2025-06-07 23:42:59,013 - INFO - üöÄ Step 1560 | SFT: 0.7525 | Meta: 0.5023 | LR: 1.70e-05
2025-06-07 23:42:59,014 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-07 23:44:45,605 - INFO - üöÄ Step 1570 | SFT: 0.7439 | Meta: 0.4953 | LR: 1.69e-05
2025-06-07 23:44:45,605 - INFO -    GPU: 36.0GB/79.3GB (45.4%)
2025-06-07 23:46:19,982 - INFO - üöÄ Step 1580 | SFT: 0.7508 | Meta: 0.5001 | LR: 1.69e-05
2025-06-07 23:46:19,982 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-07 23:47:52,267 - INFO - üöÄ Step 1590 | SFT: 0.7638 | Meta: 0.4983 | LR: 1.68e-05
2025-06-07 23:47:52,267 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-07 23:49:33,397 - INFO - üöÄ Step 1600 | SFT: 0.6513 | Meta: 0.5041 | LR: 1.68e-05
2025-06-07 23:49:33,398 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-07 23:51:00,168 - INFO - üöÄ Step 1610 | SFT: 0.7182 | Meta: 0.5019 | LR: 1.67e-05
2025-06-07 23:51:00,169 - INFO -    GPU: 35.9GB/79.3GB (45.4%)
2025-06-07 23:52:28,662 - INFO - üöÄ Step 1620 | SFT: 0.6831 | Meta: 0.5064 | LR: 1.67e-05
2025-06-07 23:52:28,662 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-07 23:53:55,811 - INFO - üöÄ Step 1630 | SFT: 0.7082 | Meta: 0.5066 | LR: 1.67e-05
2025-06-07 23:53:55,812 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-07 23:55:26,762 - INFO - üöÄ Step 1640 | SFT: 0.6747 | Meta: 0.5062 | LR: 1.66e-05
2025-06-07 23:55:26,762 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-07 23:56:56,888 - INFO - üöÄ Step 1650 | SFT: 0.7190 | Meta: 0.4970 | LR: 1.66e-05
2025-06-07 23:56:56,888 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-07 23:58:28,792 - INFO - üöÄ Step 1660 | SFT: 0.6683 | Meta: 0.4969 | LR: 1.65e-05
2025-06-07 23:58:28,793 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-07 23:59:57,715 - INFO - üöÄ Step 1670 | SFT: 0.7267 | Meta: 0.4854 | LR: 1.65e-05
2025-06-07 23:59:57,716 - INFO -    GPU: 36.0GB/79.3GB (45.4%)
2025-06-08 00:01:22,926 - INFO - üöÄ Step 1680 | SFT: 0.6532 | Meta: 0.4833 | LR: 1.64e-05
2025-06-08 00:01:22,926 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 00:02:52,472 - INFO - üöÄ Step 1690 | SFT: 0.7080 | Meta: 0.4735 | LR: 1.64e-05
2025-06-08 00:02:52,472 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 00:04:28,134 - INFO - üöÄ Step 1700 | SFT: 0.6411 | Meta: 0.4707 | LR: 1.64e-05
2025-06-08 00:04:28,135 - INFO -    GPU: 35.9GB/79.3GB (45.4%)
2025-06-08 00:05:57,940 - INFO - üöÄ Step 1710 | SFT: 0.7297 | Meta: 0.4724 | LR: 1.63e-05
2025-06-08 00:05:57,940 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 00:07:32,273 - INFO - üöÄ Step 1720 | SFT: 0.7206 | Meta: 0.4753 | LR: 1.63e-05
2025-06-08 00:07:32,273 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 00:09:05,101 - INFO - üöÄ Step 1730 | SFT: 0.7607 | Meta: 0.4840 | LR: 1.62e-05
2025-06-08 00:09:05,102 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 00:10:40,910 - INFO - üöÄ Step 1740 | SFT: 0.7269 | Meta: 0.4908 | LR: 1.62e-05
2025-06-08 00:10:40,910 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 00:12:08,436 - INFO - üöÄ Step 1750 | SFT: 0.7161 | Meta: 0.4943 | LR: 1.61e-05
2025-06-08 00:12:08,437 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 00:13:34,311 - INFO - üöÄ Step 1760 | SFT: 0.7240 | Meta: 0.4989 | LR: 1.61e-05
2025-06-08 00:13:34,311 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 00:14:55,565 - INFO - üöÄ Step 1770 | SFT: 0.7296 | Meta: 0.4966 | LR: 1.60e-05
2025-06-08 00:14:55,565 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 00:16:36,134 - INFO - üöÄ Step 1780 | SFT: 0.6321 | Meta: 0.4981 | LR: 1.60e-05
2025-06-08 00:16:36,134 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 00:18:12,281 - INFO - üöÄ Step 1790 | SFT: 0.6991 | Meta: 0.4955 | LR: 1.59e-05
2025-06-08 00:18:12,282 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 00:19:42,793 - INFO - üöÄ Step 1800 | SFT: 0.6963 | Meta: 0.5017 | LR: 1.59e-05
2025-06-08 00:19:42,793 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 00:21:09,514 - INFO - üöÄ Step 1810 | SFT: 0.6701 | Meta: 0.5005 | LR: 1.59e-05
2025-06-08 00:21:09,514 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 00:22:52,560 - INFO - üöÄ Step 1820 | SFT: 0.7318 | Meta: 0.4940 | LR: 1.58e-05
2025-06-08 00:22:52,560 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 00:24:22,942 - INFO - üöÄ Step 1830 | SFT: 0.7138 | Meta: 0.4976 | LR: 1.58e-05
2025-06-08 00:24:22,943 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 00:25:52,147 - INFO - üöÄ Step 1840 | SFT: 0.6787 | Meta: 0.4960 | LR: 1.57e-05
2025-06-08 00:25:52,147 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 00:27:18,157 - INFO - üöÄ Step 1850 | SFT: 0.6709 | Meta: 0.4916 | LR: 1.57e-05
2025-06-08 00:27:18,157 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 00:28:47,692 - INFO - üöÄ Step 1860 | SFT: 0.6655 | Meta: 0.4834 | LR: 1.56e-05
2025-06-08 00:28:47,692 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 00:30:14,802 - INFO - üöÄ Step 1870 | SFT: 0.6925 | Meta: 0.4822 | LR: 1.56e-05
2025-06-08 00:30:14,802 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 00:36:31,769 - INFO - 
============================================================
2025-06-08 00:36:31,769 - INFO - üìä VALIDATION 5/5 - Epoch 1, Step 1875
2025-06-08 00:36:31,769 - INFO - ============================================================
2025-06-08 00:36:31,769 - INFO -   ‚Ä¢ SFT Loss: 0.6841 (9000 samples)
2025-06-08 00:36:31,769 - INFO -   ‚Ä¢ Meta Loss: 0.4761 (1000 samples)
2025-06-08 00:36:31,769 - INFO -   ‚Ä¢ Average Loss: 0.6664
2025-06-08 00:36:31,769 - INFO -   ‚Ä¢ Meta-SFT Gap: -0.2080
2025-06-08 00:36:50,345 - INFO - ‚úÖ New best model saved in memory
2025-06-08 00:36:50,346 - INFO -   ‚Ä¢ Early Stop: SFT 0/3 | Meta 0/3
2025-06-08 00:36:50,346 - INFO -   ‚Ä¢ Best Avg: 0.6664 (epoch 0, step 1875)
2025-06-08 00:36:50,346 - INFO - ============================================================

2025-06-08 00:36:50,347 - INFO - üèÜ New best model! Saving...
2025-06-08 00:36:50,347 - INFO - üíæ Attempting to save model to: /root/llama3.2-3b-training/best/model
2025-06-08 00:36:50,347 - INFO -    Trying standard safe save...
2025-06-08 00:36:50,353 - WARNING -    Standard safe save failed: cannot import name 'DTensor' from 'torch.distributed.tensor' (/usr/local/lib/python3.11/dist-packages/torch/distributed/tensor/__init__.py)
2025-06-08 00:36:50,353 - INFO -    Trying without safe serialization...
2025-06-08 00:36:50,382 - WARNING -    Non-safe save failed: name 'DTensor' is not defined
2025-06-08 00:36:50,382 - INFO -    Trying manual state dict save...
2025-06-08 00:36:58,390 - INFO - ‚úÖ Manual save successful!
2025-06-08 00:37:22,556 - INFO - üíæ Checkpoint saved: /root/llama3.2-3b-training/checkpoints/checkpoint-best.pt
2025-06-08 00:37:22,558 - INFO - üíæ Saving epoch 1 checkpoint...
2025-06-08 00:37:46,803 - INFO - üíæ Checkpoint saved: /root/llama3.2-3b-training/checkpoints/checkpoint-epoch-1.pt
2025-06-08 00:37:46,803 - INFO - üéØ EPOCH 1 COMPLETED
2025-06-08 00:37:46,803 - INFO -    Time: 322.5 min
2025-06-08 00:37:46,803 - INFO -    Processed batches: 11250
2025-06-08 00:37:46,803 - INFO -    Global steps: 1875
2025-06-08 00:37:46,803 - INFO - 
üéØ EPOCH 2/3
2025-06-08 00:38:39,266 - INFO - üöÄ Step 1880 | SFT: 0.5698 | Meta: 0.4678 | LR: 1.55e-05
2025-06-08 00:38:39,266 - INFO -    GPU: 35.9GB/79.3GB (45.4%)
2025-06-08 00:40:13,179 - INFO - üöÄ Step 1890 | SFT: 0.5088 | Meta: 0.4305 | LR: 1.55e-05
2025-06-08 00:40:13,180 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 00:41:49,739 - INFO - üöÄ Step 1900 | SFT: 0.5335 | Meta: 0.4027 | LR: 1.54e-05
2025-06-08 00:41:49,739 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 00:43:14,137 - INFO - üöÄ Step 1910 | SFT: 0.4870 | Meta: 0.3857 | LR: 1.54e-05
2025-06-08 00:43:14,137 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 00:44:55,512 - INFO - üöÄ Step 1920 | SFT: 0.5378 | Meta: 0.3657 | LR: 1.53e-05
2025-06-08 00:44:55,512 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 00:46:27,797 - INFO - üöÄ Step 1930 | SFT: 0.5301 | Meta: 0.3551 | LR: 1.53e-05
2025-06-08 00:46:27,798 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 00:48:01,685 - INFO - üöÄ Step 1940 | SFT: 0.4846 | Meta: 0.3572 | LR: 1.52e-05
2025-06-08 00:48:01,685 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 00:49:31,546 - INFO - üöÄ Step 1950 | SFT: 0.5085 | Meta: 0.3628 | LR: 1.52e-05
2025-06-08 00:49:31,547 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 00:51:00,565 - INFO - üöÄ Step 1960 | SFT: 0.5181 | Meta: 0.3607 | LR: 1.51e-05
2025-06-08 00:51:00,566 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 00:52:25,709 - INFO - üöÄ Step 1970 | SFT: 0.4873 | Meta: 0.3595 | LR: 1.51e-05
2025-06-08 00:52:25,709 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 00:53:59,074 - INFO - üöÄ Step 1980 | SFT: 0.5177 | Meta: 0.3520 | LR: 1.50e-05
2025-06-08 00:53:59,074 - INFO -    GPU: 35.9GB/79.3GB (45.4%)
2025-06-08 00:55:35,048 - INFO - üöÄ Step 1990 | SFT: 0.5138 | Meta: 0.3586 | LR: 1.50e-05
2025-06-08 00:55:35,048 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 00:57:04,436 - INFO - üöÄ Step 2000 | SFT: 0.5222 | Meta: 0.3566 | LR: 1.49e-05
2025-06-08 00:57:04,436 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 00:58:34,508 - INFO - üöÄ Step 2010 | SFT: 0.5316 | Meta: 0.3528 | LR: 1.49e-05
2025-06-08 00:58:34,508 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 01:00:04,971 - INFO - üöÄ Step 2020 | SFT: 0.5245 | Meta: 0.3525 | LR: 1.48e-05
2025-06-08 01:00:04,971 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 01:01:32,663 - INFO - üöÄ Step 2030 | SFT: 0.5080 | Meta: 0.3560 | LR: 1.48e-05
2025-06-08 01:01:32,663 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 01:03:07,554 - INFO - üöÄ Step 2040 | SFT: 0.5160 | Meta: 0.3536 | LR: 1.47e-05
2025-06-08 01:03:07,555 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 01:04:43,487 - INFO - üöÄ Step 2050 | SFT: 0.5472 | Meta: 0.3537 | LR: 1.47e-05
2025-06-08 01:04:43,488 - INFO -    GPU: 35.9GB/79.3GB (45.4%)
2025-06-08 01:06:13,494 - INFO - üöÄ Step 2060 | SFT: 0.5247 | Meta: 0.3561 | LR: 1.46e-05
2025-06-08 01:06:13,494 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 01:07:45,289 - INFO - üöÄ Step 2070 | SFT: 0.4756 | Meta: 0.3528 | LR: 1.46e-05
2025-06-08 01:07:45,289 - INFO -    GPU: 35.9GB/79.3GB (45.4%)
2025-06-08 01:09:20,188 - INFO - üöÄ Step 2080 | SFT: 0.5160 | Meta: 0.3552 | LR: 1.45e-05
2025-06-08 01:09:20,188 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 01:10:47,756 - INFO - üöÄ Step 2090 | SFT: 0.5017 | Meta: 0.3528 | LR: 1.45e-05
2025-06-08 01:10:47,757 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 01:12:18,916 - INFO - üöÄ Step 2100 | SFT: 0.5099 | Meta: 0.3508 | LR: 1.44e-05
2025-06-08 01:12:18,917 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 01:13:50,149 - INFO - üöÄ Step 2110 | SFT: 0.5230 | Meta: 0.3489 | LR: 1.44e-05
2025-06-08 01:13:50,149 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 01:15:17,067 - INFO - üöÄ Step 2120 | SFT: 0.4995 | Meta: 0.3476 | LR: 1.43e-05
2025-06-08 01:15:17,068 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 01:16:45,330 - INFO - üöÄ Step 2130 | SFT: 0.4899 | Meta: 0.3521 | LR: 1.43e-05
2025-06-08 01:16:45,331 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 01:18:32,491 - INFO - üöÄ Step 2140 | SFT: 0.5144 | Meta: 0.3482 | LR: 1.42e-05
2025-06-08 01:18:32,491 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 01:20:10,403 - INFO - üöÄ Step 2150 | SFT: 0.5429 | Meta: 0.3501 | LR: 1.42e-05
2025-06-08 01:20:10,404 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 01:21:36,328 - INFO - üöÄ Step 2160 | SFT: 0.4976 | Meta: 0.3500 | LR: 1.41e-05
2025-06-08 01:21:36,328 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 01:23:08,231 - INFO - üöÄ Step 2170 | SFT: 0.5245 | Meta: 0.3604 | LR: 1.41e-05
2025-06-08 01:23:08,232 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 01:24:41,826 - INFO - üöÄ Step 2180 | SFT: 0.5040 | Meta: 0.3615 | LR: 1.40e-05
2025-06-08 01:24:41,827 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 01:26:05,615 - INFO - üöÄ Step 2190 | SFT: 0.4677 | Meta: 0.3688 | LR: 1.40e-05
2025-06-08 01:26:05,615 - INFO -    GPU: 35.9GB/79.3GB (45.4%)
2025-06-08 01:27:37,071 - INFO - üöÄ Step 2200 | SFT: 0.4740 | Meta: 0.3695 | LR: 1.39e-05
2025-06-08 01:27:37,072 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 01:29:07,400 - INFO - üöÄ Step 2210 | SFT: 0.5034 | Meta: 0.3670 | LR: 1.39e-05
2025-06-08 01:29:07,401 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 01:30:45,333 - INFO - üöÄ Step 2220 | SFT: 0.5072 | Meta: 0.3578 | LR: 1.38e-05
2025-06-08 01:30:45,334 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 01:32:18,035 - INFO - üöÄ Step 2230 | SFT: 0.4934 | Meta: 0.3554 | LR: 1.37e-05
2025-06-08 01:32:18,036 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 01:33:53,254 - INFO - üöÄ Step 2240 | SFT: 0.4807 | Meta: 0.3432 | LR: 1.37e-05
2025-06-08 01:33:53,255 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 01:40:56,446 - INFO - 
============================================================
2025-06-08 01:40:56,447 - INFO - üìä VALIDATION 1/5 - Epoch 2, Step 2250
2025-06-08 01:40:56,447 - INFO - ============================================================
2025-06-08 01:40:56,447 - INFO -   ‚Ä¢ SFT Loss: 0.6659 (9000 samples)
2025-06-08 01:40:56,447 - INFO -   ‚Ä¢ Meta Loss: 0.4624 (1000 samples)
2025-06-08 01:40:56,447 - INFO -   ‚Ä¢ Average Loss: 0.6458
2025-06-08 01:40:56,447 - INFO -   ‚Ä¢ Meta-SFT Gap: -0.2036
2025-06-08 01:41:12,192 - INFO - ‚úÖ New best model saved in memory
2025-06-08 01:41:12,193 - INFO -   ‚Ä¢ Early Stop: SFT 0/3 | Meta 0/3
2025-06-08 01:41:12,193 - INFO -   ‚Ä¢ Best Avg: 0.6458 (epoch 1, step 2250)
2025-06-08 01:41:12,193 - INFO - ============================================================

2025-06-08 01:41:12,193 - INFO - üèÜ New best model! Saving...
2025-06-08 01:41:12,193 - INFO - üíæ Attempting to save model to: /root/llama3.2-3b-training/best/model
2025-06-08 01:41:12,194 - INFO -    Trying standard safe save...
2025-06-08 01:41:12,199 - WARNING -    Standard safe save failed: cannot import name 'DTensor' from 'torch.distributed.tensor' (/usr/local/lib/python3.11/dist-packages/torch/distributed/tensor/__init__.py)
2025-06-08 01:41:12,200 - INFO -    Trying without safe serialization...
2025-06-08 01:41:12,224 - WARNING -    Non-safe save failed: name 'DTensor' is not defined
2025-06-08 01:41:12,224 - INFO -    Trying manual state dict save...
2025-06-08 01:41:21,355 - INFO - ‚úÖ Manual save successful!
2025-06-08 01:41:47,079 - INFO - üíæ Checkpoint saved: /root/llama3.2-3b-training/checkpoints/checkpoint-best.pt
2025-06-08 01:41:47,080 - INFO - üöÄ Step 2250 | SFT: 0.4821 | Meta: 0.3427 | LR: 1.36e-05
2025-06-08 01:41:47,080 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 01:43:22,437 - INFO - üöÄ Step 2260 | SFT: 0.4712 | Meta: 0.3365 | LR: 1.36e-05
2025-06-08 01:43:22,437 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 01:44:55,046 - INFO - üöÄ Step 2270 | SFT: 0.4815 | Meta: 0.3365 | LR: 1.35e-05
2025-06-08 01:44:55,046 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 01:46:32,718 - INFO - üöÄ Step 2280 | SFT: 0.4783 | Meta: 0.3361 | LR: 1.35e-05
2025-06-08 01:46:32,718 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 01:48:10,843 - INFO - üöÄ Step 2290 | SFT: 0.5143 | Meta: 0.3320 | LR: 1.34e-05
2025-06-08 01:48:10,843 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 01:49:50,489 - INFO - üöÄ Step 2300 | SFT: 0.4629 | Meta: 0.3293 | LR: 1.34e-05
2025-06-08 01:49:50,490 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 01:51:27,292 - INFO - üöÄ Step 2310 | SFT: 0.5144 | Meta: 0.3351 | LR: 1.33e-05
2025-06-08 01:51:27,292 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 01:53:02,435 - INFO - üöÄ Step 2320 | SFT: 0.5272 | Meta: 0.3311 | LR: 1.33e-05
2025-06-08 01:53:02,435 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 01:54:29,139 - INFO - üöÄ Step 2330 | SFT: 0.5177 | Meta: 0.3365 | LR: 1.32e-05
2025-06-08 01:54:29,140 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 01:56:00,951 - INFO - üöÄ Step 2340 | SFT: 0.5384 | Meta: 0.3364 | LR: 1.31e-05
2025-06-08 01:56:00,951 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 01:57:26,989 - INFO - üöÄ Step 2350 | SFT: 0.5064 | Meta: 0.3382 | LR: 1.31e-05
2025-06-08 01:57:26,990 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 01:59:10,077 - INFO - üöÄ Step 2360 | SFT: 0.5357 | Meta: 0.3387 | LR: 1.30e-05
2025-06-08 01:59:10,077 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 02:00:51,842 - INFO - üöÄ Step 2370 | SFT: 0.5320 | Meta: 0.3430 | LR: 1.30e-05
2025-06-08 02:00:51,842 - INFO -    GPU: 35.9GB/79.3GB (45.4%)
2025-06-08 02:02:28,996 - INFO - üöÄ Step 2380 | SFT: 0.4931 | Meta: 0.3400 | LR: 1.29e-05
2025-06-08 02:02:28,997 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 02:03:53,713 - INFO - üöÄ Step 2390 | SFT: 0.5237 | Meta: 0.3443 | LR: 1.29e-05
2025-06-08 02:03:53,713 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 02:05:19,904 - INFO - üöÄ Step 2400 | SFT: 0.4868 | Meta: 0.3427 | LR: 1.28e-05
2025-06-08 02:05:19,904 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 02:06:57,971 - INFO - üöÄ Step 2410 | SFT: 0.4600 | Meta: 0.3423 | LR: 1.28e-05
2025-06-08 02:06:57,972 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 02:08:20,719 - INFO - üöÄ Step 2420 | SFT: 0.4368 | Meta: 0.3419 | LR: 1.27e-05
2025-06-08 02:08:20,719 - INFO -    GPU: 36.0GB/79.3GB (45.4%)
2025-06-08 02:09:58,608 - INFO - üöÄ Step 2430 | SFT: 0.4540 | Meta: 0.3334 | LR: 1.27e-05
2025-06-08 02:09:58,608 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 02:11:28,768 - INFO - üöÄ Step 2440 | SFT: 0.4835 | Meta: 0.3339 | LR: 1.26e-05
2025-06-08 02:11:28,768 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 02:12:55,314 - INFO - üöÄ Step 2450 | SFT: 0.5086 | Meta: 0.3332 | LR: 1.25e-05
2025-06-08 02:12:55,315 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 02:14:26,394 - INFO - üöÄ Step 2460 | SFT: 0.5059 | Meta: 0.3343 | LR: 1.25e-05
2025-06-08 02:14:26,394 - INFO -    GPU: 35.9GB/79.3GB (45.4%)
2025-06-08 02:15:53,165 - INFO - üöÄ Step 2470 | SFT: 0.4835 | Meta: 0.3321 | LR: 1.24e-05
2025-06-08 02:15:53,165 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 02:17:33,023 - INFO - üöÄ Step 2480 | SFT: 0.4935 | Meta: 0.3347 | LR: 1.24e-05
2025-06-08 02:17:33,023 - INFO -    GPU: 35.9GB/79.3GB (45.4%)
2025-06-08 02:19:06,298 - INFO - üöÄ Step 2490 | SFT: 0.4991 | Meta: 0.3352 | LR: 1.23e-05
2025-06-08 02:19:06,298 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 02:20:39,323 - INFO - üöÄ Step 2500 | SFT: 0.5278 | Meta: 0.3302 | LR: 1.23e-05
2025-06-08 02:20:39,323 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 02:22:11,457 - INFO - üöÄ Step 2510 | SFT: 0.4679 | Meta: 0.3334 | LR: 1.22e-05
2025-06-08 02:22:11,457 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 02:23:36,705 - INFO - üöÄ Step 2520 | SFT: 0.5080 | Meta: 0.3386 | LR: 1.22e-05
2025-06-08 02:23:36,706 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 02:25:13,844 - INFO - üöÄ Step 2530 | SFT: 0.5003 | Meta: 0.3446 | LR: 1.21e-05
2025-06-08 02:25:13,844 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 02:26:43,627 - INFO - üöÄ Step 2540 | SFT: 0.4874 | Meta: 0.3459 | LR: 1.20e-05
2025-06-08 02:26:43,627 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 02:28:17,127 - INFO - üöÄ Step 2550 | SFT: 0.4957 | Meta: 0.3450 | LR: 1.20e-05
2025-06-08 02:28:17,128 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 02:29:58,329 - INFO - üöÄ Step 2560 | SFT: 0.4797 | Meta: 0.3426 | LR: 1.19e-05
2025-06-08 02:29:58,330 - INFO -    GPU: 35.9GB/79.3GB (45.4%)
2025-06-08 02:31:23,029 - INFO - üöÄ Step 2570 | SFT: 0.4880 | Meta: 0.3309 | LR: 1.19e-05
2025-06-08 02:31:23,029 - INFO -    GPU: 36.0GB/79.3GB (45.4%)
2025-06-08 02:32:51,984 - INFO - üöÄ Step 2580 | SFT: 0.4929 | Meta: 0.3225 | LR: 1.18e-05
2025-06-08 02:32:51,984 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 02:34:32,326 - INFO - üöÄ Step 2590 | SFT: 0.4687 | Meta: 0.3165 | LR: 1.18e-05
2025-06-08 02:34:32,327 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 02:36:09,936 - INFO - üöÄ Step 2600 | SFT: 0.4928 | Meta: 0.3161 | LR: 1.17e-05
2025-06-08 02:36:09,936 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 02:37:44,882 - INFO - üöÄ Step 2610 | SFT: 0.4625 | Meta: 0.3137 | LR: 1.16e-05
2025-06-08 02:37:44,882 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 02:39:19,982 - INFO - üöÄ Step 2620 | SFT: 0.5050 | Meta: 0.3159 | LR: 1.16e-05
2025-06-08 02:39:19,983 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 02:45:39,064 - INFO - 
============================================================
2025-06-08 02:45:39,064 - INFO - üìä VALIDATION 2/5 - Epoch 2, Step 2625
2025-06-08 02:45:39,064 - INFO - ============================================================
2025-06-08 02:45:39,064 - INFO -   ‚Ä¢ SFT Loss: 0.6398 (9000 samples)
2025-06-08 02:45:39,064 - INFO -   ‚Ä¢ Meta Loss: 0.4457 (1000 samples)
2025-06-08 02:45:39,064 - INFO -   ‚Ä¢ Average Loss: 0.6194
2025-06-08 02:45:39,064 - INFO -   ‚Ä¢ Meta-SFT Gap: -0.1942
2025-06-08 02:45:53,395 - INFO - ‚úÖ New best model saved in memory
2025-06-08 02:45:53,395 - INFO -   ‚Ä¢ Early Stop: SFT 0/3 | Meta 0/3
2025-06-08 02:45:53,396 - INFO -   ‚Ä¢ Best Avg: 0.6194 (epoch 1, step 2625)
2025-06-08 02:45:53,396 - INFO - ============================================================

2025-06-08 02:45:53,396 - INFO - üèÜ New best model! Saving...
2025-06-08 02:45:53,397 - INFO - üíæ Attempting to save model to: /root/llama3.2-3b-training/best/model
2025-06-08 02:45:53,397 - INFO -    Trying standard safe save...
2025-06-08 02:45:53,401 - WARNING -    Standard safe save failed: cannot import name 'DTensor' from 'torch.distributed.tensor' (/usr/local/lib/python3.11/dist-packages/torch/distributed/tensor/__init__.py)
2025-06-08 02:45:53,401 - INFO -    Trying without safe serialization...
2025-06-08 02:45:53,424 - WARNING -    Non-safe save failed: name 'DTensor' is not defined
2025-06-08 02:45:53,424 - INFO -    Trying manual state dict save...
2025-06-08 02:46:00,691 - INFO - ‚úÖ Manual save successful!
2025-06-08 02:46:21,611 - INFO - üíæ Checkpoint saved: /root/llama3.2-3b-training/checkpoints/checkpoint-best.pt
2025-06-08 02:47:06,856 - INFO - üöÄ Step 2630 | SFT: 0.5167 | Meta: 0.3272 | LR: 1.15e-05
2025-06-08 02:47:06,856 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 02:48:41,274 - INFO - üöÄ Step 2640 | SFT: 0.4949 | Meta: 0.3281 | LR: 1.15e-05
2025-06-08 02:48:41,274 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 02:50:21,084 - INFO - üöÄ Step 2650 | SFT: 0.4692 | Meta: 0.3270 | LR: 1.14e-05
2025-06-08 02:50:21,084 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 02:51:50,351 - INFO - üöÄ Step 2660 | SFT: 0.4530 | Meta: 0.3287 | LR: 1.14e-05
2025-06-08 02:51:50,351 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 02:53:23,800 - INFO - üöÄ Step 2670 | SFT: 0.5170 | Meta: 0.3296 | LR: 1.13e-05
2025-06-08 02:53:23,800 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 02:54:57,811 - INFO - üöÄ Step 2680 | SFT: 0.4794 | Meta: 0.3203 | LR: 1.12e-05
2025-06-08 02:54:57,812 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 02:56:23,729 - INFO - üöÄ Step 2690 | SFT: 0.5209 | Meta: 0.3206 | LR: 1.12e-05
2025-06-08 02:56:23,729 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 02:57:45,948 - INFO - üöÄ Step 2700 | SFT: 0.4651 | Meta: 0.3236 | LR: 1.11e-05
2025-06-08 02:57:45,948 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 02:59:22,644 - INFO - üöÄ Step 2710 | SFT: 0.4692 | Meta: 0.3266 | LR: 1.11e-05
2025-06-08 02:59:22,644 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 03:00:59,199 - INFO - üöÄ Step 2720 | SFT: 0.4407 | Meta: 0.3258 | LR: 1.10e-05
2025-06-08 03:00:59,199 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 03:02:37,007 - INFO - üöÄ Step 2730 | SFT: 0.4272 | Meta: 0.3286 | LR: 1.10e-05
2025-06-08 03:02:37,008 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 03:04:09,342 - INFO - üöÄ Step 2740 | SFT: 0.4792 | Meta: 0.3239 | LR: 1.09e-05
2025-06-08 03:04:09,343 - INFO -    GPU: 35.9GB/79.3GB (45.4%)
2025-06-08 03:05:41,400 - INFO - üöÄ Step 2750 | SFT: 0.5036 | Meta: 0.3194 | LR: 1.08e-05
2025-06-08 03:05:41,401 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 03:07:14,273 - INFO - üöÄ Step 2760 | SFT: 0.4217 | Meta: 0.3175 | LR: 1.08e-05
2025-06-08 03:07:14,273 - INFO -    GPU: 35.9GB/79.3GB (45.4%)
2025-06-08 03:08:39,038 - INFO - üöÄ Step 2770 | SFT: 0.4699 | Meta: 0.3176 | LR: 1.07e-05
2025-06-08 03:08:39,038 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 03:09:59,945 - ERROR - Critical error in enhanced loss computation: CUDA out of memory. Tried to allocate 1.57 GiB. GPU 0 has a total capacity of 79.25 GiB of which 386.94 MiB is free. Process 3174301 has 78.87 GiB memory in use. Of the allocated memory 77.81 GiB is allocated by PyTorch, and 575.32 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-06-08 03:10:10,292 - INFO - üöÄ Step 2780 | SFT: 0.5118 | Meta: 0.3255 | LR: 1.07e-05
2025-06-08 03:10:10,292 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 03:11:47,475 - INFO - üöÄ Step 2790 | SFT: 0.4570 | Meta: 0.3243 | LR: 1.06e-05
2025-06-08 03:11:47,475 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 03:13:23,395 - INFO - üöÄ Step 2800 | SFT: 0.5028 | Meta: 0.3256 | LR: 1.06e-05
2025-06-08 03:13:23,395 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 03:15:00,977 - INFO - üöÄ Step 2810 | SFT: 0.4562 | Meta: 0.3266 | LR: 1.05e-05
2025-06-08 03:15:00,978 - INFO -    GPU: 35.9GB/79.3GB (45.4%)
2025-06-08 03:16:29,246 - INFO - üöÄ Step 2820 | SFT: 0.4308 | Meta: 0.3260 | LR: 1.04e-05
2025-06-08 03:16:29,247 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 03:17:59,776 - INFO - üöÄ Step 2830 | SFT: 0.4767 | Meta: 0.3244 | LR: 1.04e-05
2025-06-08 03:17:59,776 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 03:19:39,607 - INFO - üöÄ Step 2840 | SFT: 0.4745 | Meta: 0.3217 | LR: 1.03e-05
2025-06-08 03:19:39,607 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 03:21:09,828 - INFO - üöÄ Step 2850 | SFT: 0.4785 | Meta: 0.3215 | LR: 1.03e-05
2025-06-08 03:21:09,829 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 03:22:48,886 - INFO - üöÄ Step 2860 | SFT: 0.4530 | Meta: 0.3154 | LR: 1.02e-05
2025-06-08 03:22:48,886 - INFO -    GPU: 36.0GB/79.3GB (45.4%)
2025-06-08 03:24:17,590 - INFO - üöÄ Step 2870 | SFT: 0.4674 | Meta: 0.3074 | LR: 1.02e-05
2025-06-08 03:24:17,590 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 03:25:47,911 - INFO - üöÄ Step 2880 | SFT: 0.4557 | Meta: 0.3093 | LR: 1.01e-05
2025-06-08 03:25:47,911 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 03:27:19,202 - INFO - üöÄ Step 2890 | SFT: 0.4515 | Meta: 0.3071 | LR: 1.00e-05
2025-06-08 03:27:19,202 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 03:28:48,695 - INFO - üöÄ Step 2900 | SFT: 0.4993 | Meta: 0.3075 | LR: 9.98e-06
2025-06-08 03:28:48,695 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 03:30:17,334 - INFO - üöÄ Step 2910 | SFT: 0.4712 | Meta: 0.3108 | LR: 9.92e-06
2025-06-08 03:30:17,334 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 03:31:55,082 - INFO - üöÄ Step 2920 | SFT: 0.4651 | Meta: 0.3147 | LR: 9.86e-06
2025-06-08 03:31:55,082 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 03:33:30,557 - INFO - üöÄ Step 2930 | SFT: 0.4095 | Meta: 0.3179 | LR: 9.81e-06
2025-06-08 03:33:30,558 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 03:35:06,609 - INFO - üöÄ Step 2940 | SFT: 0.4958 | Meta: 0.3175 | LR: 9.75e-06
2025-06-08 03:35:06,609 - INFO -    GPU: 36.0GB/79.3GB (45.4%)
2025-06-08 03:36:40,807 - INFO - üöÄ Step 2950 | SFT: 0.4259 | Meta: 0.3089 | LR: 9.69e-06
2025-06-08 03:36:40,807 - INFO -    GPU: 35.9GB/79.3GB (45.4%)
2025-06-08 03:38:18,853 - INFO - üöÄ Step 2960 | SFT: 0.5168 | Meta: 0.3071 | LR: 9.63e-06
2025-06-08 03:38:18,853 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 03:39:54,146 - INFO - üöÄ Step 2970 | SFT: 0.4847 | Meta: 0.3057 | LR: 9.58e-06
2025-06-08 03:39:54,146 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 03:41:28,758 - INFO - üöÄ Step 2980 | SFT: 0.4807 | Meta: 0.3056 | LR: 9.52e-06
2025-06-08 03:41:28,759 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 03:42:59,604 - INFO - üöÄ Step 2990 | SFT: 0.5158 | Meta: 0.3136 | LR: 9.46e-06
2025-06-08 03:42:59,604 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 03:50:13,141 - INFO - 
============================================================
2025-06-08 03:50:13,141 - INFO - üìä VALIDATION 3/5 - Epoch 2, Step 3000
2025-06-08 03:50:13,141 - INFO - ============================================================
2025-06-08 03:50:13,142 - INFO -   ‚Ä¢ SFT Loss: 0.6183 (9000 samples)
2025-06-08 03:50:13,142 - INFO -   ‚Ä¢ Meta Loss: 0.4267 (1000 samples)
2025-06-08 03:50:13,142 - INFO -   ‚Ä¢ Average Loss: 0.5966
2025-06-08 03:50:13,142 - INFO -   ‚Ä¢ Meta-SFT Gap: -0.1916
2025-06-08 03:50:28,529 - INFO - ‚úÖ New best model saved in memory
2025-06-08 03:50:28,530 - INFO -   ‚Ä¢ Early Stop: SFT 0/3 | Meta 0/3
2025-06-08 03:50:28,530 - INFO -   ‚Ä¢ Best Avg: 0.5966 (epoch 1, step 3000)
2025-06-08 03:50:28,530 - INFO - ============================================================

2025-06-08 03:50:28,530 - INFO - üèÜ New best model! Saving...
2025-06-08 03:50:28,530 - INFO - üíæ Attempting to save model to: /root/llama3.2-3b-training/best/model
2025-06-08 03:50:28,531 - INFO -    Trying standard safe save...
2025-06-08 03:50:28,535 - WARNING -    Standard safe save failed: cannot import name 'DTensor' from 'torch.distributed.tensor' (/usr/local/lib/python3.11/dist-packages/torch/distributed/tensor/__init__.py)
2025-06-08 03:50:28,535 - INFO -    Trying without safe serialization...
2025-06-08 03:50:28,557 - WARNING -    Non-safe save failed: name 'DTensor' is not defined
2025-06-08 03:50:28,557 - INFO -    Trying manual state dict save...
2025-06-08 03:50:35,854 - INFO - ‚úÖ Manual save successful!
2025-06-08 03:50:59,896 - INFO - üíæ Checkpoint saved: /root/llama3.2-3b-training/checkpoints/checkpoint-best.pt
2025-06-08 03:50:59,898 - INFO - üöÄ Step 3000 | SFT: 0.4874 | Meta: 0.3184 | LR: 9.40e-06
2025-06-08 03:50:59,898 - INFO -    GPU: 35.9GB/79.3GB (45.4%)
2025-06-08 03:52:42,714 - INFO - üöÄ Step 3010 | SFT: 0.4578 | Meta: 0.3155 | LR: 9.35e-06
2025-06-08 03:52:42,714 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 03:54:07,906 - INFO - üöÄ Step 3020 | SFT: 0.4688 | Meta: 0.3196 | LR: 9.29e-06
2025-06-08 03:54:07,907 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 03:55:47,143 - INFO - üöÄ Step 3030 | SFT: 0.4842 | Meta: 0.3123 | LR: 9.23e-06
2025-06-08 03:55:47,143 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 03:57:15,650 - INFO - üöÄ Step 3040 | SFT: 0.4836 | Meta: 0.3115 | LR: 9.17e-06
2025-06-08 03:57:15,650 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 03:58:46,549 - INFO - üöÄ Step 3050 | SFT: 0.4787 | Meta: 0.3143 | LR: 9.12e-06
2025-06-08 03:58:46,549 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 04:00:24,580 - INFO - üöÄ Step 3060 | SFT: 0.4877 | Meta: 0.3137 | LR: 9.06e-06
2025-06-08 04:00:24,580 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 04:02:06,553 - INFO - üöÄ Step 3070 | SFT: 0.4292 | Meta: 0.3102 | LR: 9.00e-06
2025-06-08 04:02:06,554 - INFO -    GPU: 36.0GB/79.3GB (45.4%)
2025-06-08 04:03:38,587 - INFO - üöÄ Step 3080 | SFT: 0.5120 | Meta: 0.3110 | LR: 8.95e-06
2025-06-08 04:03:38,588 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 04:05:12,899 - INFO - üöÄ Step 3090 | SFT: 0.4551 | Meta: 0.3106 | LR: 8.89e-06
2025-06-08 04:05:12,899 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 04:06:43,328 - INFO - üöÄ Step 3100 | SFT: 0.4661 | Meta: 0.3065 | LR: 8.83e-06
2025-06-08 04:06:43,329 - INFO -    GPU: 36.0GB/79.3GB (45.4%)
2025-06-08 04:08:11,309 - INFO - üöÄ Step 3110 | SFT: 0.4711 | Meta: 0.3063 | LR: 8.77e-06
2025-06-08 04:08:11,310 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 04:09:42,698 - INFO - üöÄ Step 3120 | SFT: 0.4339 | Meta: 0.3112 | LR: 8.72e-06
2025-06-08 04:09:42,698 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 04:11:09,182 - INFO - üöÄ Step 3130 | SFT: 0.4475 | Meta: 0.3064 | LR: 8.66e-06
2025-06-08 04:11:09,183 - INFO -    GPU: 35.9GB/79.3GB (45.4%)
2025-06-08 04:12:36,070 - INFO - üöÄ Step 3140 | SFT: 0.5127 | Meta: 0.3099 | LR: 8.60e-06
2025-06-08 04:12:36,070 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 04:13:59,458 - INFO - üöÄ Step 3150 | SFT: 0.5063 | Meta: 0.3056 | LR: 8.55e-06
2025-06-08 04:13:59,458 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 04:15:31,558 - INFO - üöÄ Step 3160 | SFT: 0.4485 | Meta: 0.3082 | LR: 8.49e-06
2025-06-08 04:15:31,558 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 04:17:06,299 - INFO - üöÄ Step 3170 | SFT: 0.4592 | Meta: 0.3107 | LR: 8.43e-06
2025-06-08 04:17:06,299 - INFO -    GPU: 35.9GB/79.3GB (45.4%)
2025-06-08 04:18:41,452 - INFO - üöÄ Step 3180 | SFT: 0.4563 | Meta: 0.3080 | LR: 8.38e-06
2025-06-08 04:18:41,452 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 04:20:13,795 - INFO - üöÄ Step 3190 | SFT: 0.4237 | Meta: 0.3053 | LR: 8.32e-06
2025-06-08 04:20:13,795 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 04:21:44,157 - INFO - üöÄ Step 3200 | SFT: 0.4769 | Meta: 0.3024 | LR: 8.26e-06
2025-06-08 04:21:44,157 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 04:23:08,725 - INFO - üöÄ Step 3210 | SFT: 0.4656 | Meta: 0.3034 | LR: 8.20e-06
2025-06-08 04:23:08,725 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 04:24:51,638 - INFO - üöÄ Step 3220 | SFT: 0.4523 | Meta: 0.2995 | LR: 8.15e-06
2025-06-08 04:24:51,638 - INFO -    GPU: 35.9GB/79.3GB (45.4%)
2025-06-08 04:26:29,012 - INFO - üöÄ Step 3230 | SFT: 0.4798 | Meta: 0.2993 | LR: 8.09e-06
2025-06-08 04:26:29,013 - INFO -    GPU: 35.9GB/79.3GB (45.4%)
2025-06-08 04:28:08,862 - INFO - üöÄ Step 3240 | SFT: 0.4894 | Meta: 0.3021 | LR: 8.04e-06
2025-06-08 04:28:08,862 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 04:29:36,403 - INFO - üöÄ Step 3250 | SFT: 0.4487 | Meta: 0.3082 | LR: 7.98e-06
2025-06-08 04:29:36,403 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 04:31:12,449 - INFO - üöÄ Step 3260 | SFT: 0.4695 | Meta: 0.3077 | LR: 7.92e-06
2025-06-08 04:31:12,450 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 04:32:46,576 - INFO - üöÄ Step 3270 | SFT: 0.4460 | Meta: 0.3128 | LR: 7.87e-06
2025-06-08 04:32:46,576 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 04:34:12,992 - INFO - üöÄ Step 3280 | SFT: 0.4248 | Meta: 0.3102 | LR: 7.81e-06
2025-06-08 04:34:12,993 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 04:35:39,439 - INFO - üöÄ Step 3290 | SFT: 0.4324 | Meta: 0.3083 | LR: 7.75e-06
2025-06-08 04:35:39,439 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 04:37:21,635 - INFO - üöÄ Step 3300 | SFT: 0.4588 | Meta: 0.3019 | LR: 7.70e-06
2025-06-08 04:37:21,635 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 04:38:58,314 - INFO - üöÄ Step 3310 | SFT: 0.4953 | Meta: 0.3020 | LR: 7.64e-06
2025-06-08 04:38:58,314 - INFO -    GPU: 35.9GB/79.3GB (45.4%)
2025-06-08 04:40:31,113 - INFO - üöÄ Step 3320 | SFT: 0.4392 | Meta: 0.3015 | LR: 7.59e-06
2025-06-08 04:40:31,113 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 04:42:00,895 - INFO - üöÄ Step 3330 | SFT: 0.4405 | Meta: 0.3067 | LR: 7.53e-06
2025-06-08 04:42:00,895 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 04:43:38,293 - INFO - üöÄ Step 3340 | SFT: 0.4207 | Meta: 0.3087 | LR: 7.47e-06
2025-06-08 04:43:38,294 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 04:45:13,497 - INFO - üöÄ Step 3350 | SFT: 0.4450 | Meta: 0.3056 | LR: 7.42e-06
2025-06-08 04:45:13,497 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 04:46:45,566 - INFO - üöÄ Step 3360 | SFT: 0.5016 | Meta: 0.3007 | LR: 7.36e-06
2025-06-08 04:46:45,567 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 04:48:19,533 - INFO - üöÄ Step 3370 | SFT: 0.4326 | Meta: 0.3014 | LR: 7.31e-06
2025-06-08 04:48:19,533 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 04:54:39,813 - INFO - 
============================================================
2025-06-08 04:54:39,813 - INFO - üìä VALIDATION 4/5 - Epoch 2, Step 3375
2025-06-08 04:54:39,813 - INFO - ============================================================
2025-06-08 04:54:39,813 - INFO -   ‚Ä¢ SFT Loss: 0.5948 (9000 samples)
2025-06-08 04:54:39,813 - INFO -   ‚Ä¢ Meta Loss: 0.4085 (1000 samples)
2025-06-08 04:54:39,813 - INFO -   ‚Ä¢ Average Loss: 0.5729
2025-06-08 04:54:39,813 - INFO -   ‚Ä¢ Meta-SFT Gap: -0.1863
2025-06-08 04:54:53,976 - INFO - ‚úÖ New best model saved in memory
2025-06-08 04:54:53,977 - INFO -   ‚Ä¢ Early Stop: SFT 0/3 | Meta 0/3
2025-06-08 04:54:53,977 - INFO -   ‚Ä¢ Best Avg: 0.5729 (epoch 1, step 3375)
2025-06-08 04:54:53,977 - INFO - ============================================================

2025-06-08 04:54:53,978 - INFO - üèÜ New best model! Saving...
2025-06-08 04:54:53,978 - INFO - üíæ Attempting to save model to: /root/llama3.2-3b-training/best/model
2025-06-08 04:54:53,978 - INFO -    Trying standard safe save...
2025-06-08 04:54:53,982 - WARNING -    Standard safe save failed: cannot import name 'DTensor' from 'torch.distributed.tensor' (/usr/local/lib/python3.11/dist-packages/torch/distributed/tensor/__init__.py)
2025-06-08 04:54:53,982 - INFO -    Trying without safe serialization...
2025-06-08 04:54:54,004 - WARNING -    Non-safe save failed: name 'DTensor' is not defined
2025-06-08 04:54:54,004 - INFO -    Trying manual state dict save...
2025-06-08 04:55:00,825 - INFO - ‚úÖ Manual save successful!
2025-06-08 04:55:21,983 - INFO - üíæ Checkpoint saved: /root/llama3.2-3b-training/checkpoints/checkpoint-best.pt
2025-06-08 04:56:10,820 - INFO - üöÄ Step 3380 | SFT: 0.4667 | Meta: 0.2964 | LR: 7.25e-06
2025-06-08 04:56:10,820 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 04:57:44,354 - INFO - üöÄ Step 3390 | SFT: 0.4449 | Meta: 0.2976 | LR: 7.20e-06
2025-06-08 04:57:44,354 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 04:59:11,009 - INFO - üöÄ Step 3400 | SFT: 0.4375 | Meta: 0.3036 | LR: 7.14e-06
2025-06-08 04:59:11,009 - INFO -    GPU: 35.9GB/79.3GB (45.4%)
2025-06-08 05:00:48,933 - INFO - üöÄ Step 3410 | SFT: 0.4136 | Meta: 0.3060 | LR: 7.09e-06
2025-06-08 05:00:48,933 - INFO -    GPU: 35.9GB/79.3GB (45.4%)
2025-06-08 05:02:25,161 - INFO - üöÄ Step 3420 | SFT: 0.4307 | Meta: 0.3047 | LR: 7.03e-06
2025-06-08 05:02:25,161 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 05:04:02,096 - INFO - üöÄ Step 3430 | SFT: 0.4713 | Meta: 0.3077 | LR: 6.98e-06
2025-06-08 05:04:02,097 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 05:05:27,093 - INFO - üöÄ Step 3440 | SFT: 0.4401 | Meta: 0.3052 | LR: 6.92e-06
2025-06-08 05:05:27,094 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 05:06:55,123 - INFO - üöÄ Step 3450 | SFT: 0.4419 | Meta: 0.2955 | LR: 6.87e-06
2025-06-08 05:06:55,124 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 05:08:25,560 - INFO - üöÄ Step 3460 | SFT: 0.4322 | Meta: 0.2945 | LR: 6.81e-06
2025-06-08 05:08:25,560 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 05:10:04,741 - INFO - üöÄ Step 3470 | SFT: 0.4273 | Meta: 0.2933 | LR: 6.76e-06
2025-06-08 05:10:04,741 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 05:11:37,702 - INFO - üöÄ Step 3480 | SFT: 0.4793 | Meta: 0.2963 | LR: 6.70e-06
2025-06-08 05:11:37,702 - INFO -    GPU: 35.9GB/79.3GB (45.4%)
2025-06-08 05:13:08,793 - INFO - üöÄ Step 3490 | SFT: 0.4354 | Meta: 0.2993 | LR: 6.65e-06
2025-06-08 05:13:08,794 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 05:14:41,434 - INFO - üöÄ Step 3500 | SFT: 0.4563 | Meta: 0.3000 | LR: 6.60e-06
2025-06-08 05:14:41,435 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 05:16:15,530 - INFO - üöÄ Step 3510 | SFT: 0.4331 | Meta: 0.3024 | LR: 6.54e-06
2025-06-08 05:16:15,531 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 05:17:48,309 - INFO - üöÄ Step 3520 | SFT: 0.4712 | Meta: 0.2961 | LR: 6.49e-06
2025-06-08 05:17:48,309 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 05:19:09,942 - INFO - üöÄ Step 3530 | SFT: 0.4305 | Meta: 0.2924 | LR: 6.43e-06
2025-06-08 05:19:09,943 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 05:20:36,033 - INFO - üöÄ Step 3540 | SFT: 0.4496 | Meta: 0.2869 | LR: 6.38e-06
2025-06-08 05:20:36,033 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 05:22:07,676 - INFO - üöÄ Step 3550 | SFT: 0.4911 | Meta: 0.2904 | LR: 6.33e-06
2025-06-08 05:22:07,676 - INFO -    GPU: 35.9GB/79.3GB (45.4%)
2025-06-08 05:23:50,922 - INFO - üöÄ Step 3560 | SFT: 0.4613 | Meta: 0.2908 | LR: 6.27e-06
2025-06-08 05:23:50,922 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 05:25:22,799 - INFO - üöÄ Step 3570 | SFT: 0.3966 | Meta: 0.2864 | LR: 6.22e-06
2025-06-08 05:25:22,799 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 05:26:53,728 - INFO - üöÄ Step 3580 | SFT: 0.4740 | Meta: 0.2920 | LR: 6.17e-06
2025-06-08 05:26:53,728 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 05:28:30,715 - INFO - üöÄ Step 3590 | SFT: 0.4425 | Meta: 0.2949 | LR: 6.11e-06
2025-06-08 05:28:30,715 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 05:30:16,052 - INFO - üöÄ Step 3600 | SFT: 0.4341 | Meta: 0.2912 | LR: 6.06e-06
2025-06-08 05:30:16,053 - INFO -    GPU: 35.9GB/79.3GB (45.4%)
2025-06-08 05:31:47,723 - INFO - üöÄ Step 3610 | SFT: 0.4244 | Meta: 0.2913 | LR: 6.01e-06
2025-06-08 05:31:47,723 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 05:33:13,907 - INFO - üöÄ Step 3620 | SFT: 0.4360 | Meta: 0.2897 | LR: 5.95e-06
2025-06-08 05:33:13,907 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 05:34:49,843 - INFO - üöÄ Step 3630 | SFT: 0.4713 | Meta: 0.2900 | LR: 5.90e-06
2025-06-08 05:34:49,843 - INFO -    GPU: 35.9GB/79.3GB (45.4%)
2025-06-08 05:36:22,894 - INFO - üöÄ Step 3640 | SFT: 0.4649 | Meta: 0.2856 | LR: 5.85e-06
2025-06-08 05:36:22,894 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 05:38:00,136 - INFO - üöÄ Step 3650 | SFT: 0.4420 | Meta: 0.2941 | LR: 5.80e-06
2025-06-08 05:38:00,137 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 05:39:23,432 - INFO - üöÄ Step 3660 | SFT: 0.4250 | Meta: 0.2893 | LR: 5.74e-06
2025-06-08 05:39:23,432 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 05:40:51,187 - INFO - üöÄ Step 3670 | SFT: 0.4359 | Meta: 0.2942 | LR: 5.69e-06
2025-06-08 05:40:51,188 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 05:42:16,790 - INFO - üöÄ Step 3680 | SFT: 0.4392 | Meta: 0.2935 | LR: 5.64e-06
2025-06-08 05:42:16,791 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 05:43:47,148 - INFO - üöÄ Step 3690 | SFT: 0.4577 | Meta: 0.2934 | LR: 5.59e-06
2025-06-08 05:43:47,149 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 05:45:16,034 - INFO - üöÄ Step 3700 | SFT: 0.4297 | Meta: 0.2866 | LR: 5.54e-06
2025-06-08 05:45:16,035 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 05:46:51,280 - INFO - üöÄ Step 3710 | SFT: 0.4722 | Meta: 0.2873 | LR: 5.49e-06
2025-06-08 05:46:51,280 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 05:48:19,248 - INFO - üöÄ Step 3720 | SFT: 0.4049 | Meta: 0.2873 | LR: 5.43e-06
2025-06-08 05:48:19,248 - INFO -    GPU: 35.9GB/79.3GB (45.4%)
2025-06-08 05:49:45,643 - INFO - üöÄ Step 3730 | SFT: 0.4595 | Meta: 0.2932 | LR: 5.38e-06
2025-06-08 05:49:45,643 - INFO -    GPU: 36.0GB/79.3GB (45.4%)
2025-06-08 05:51:13,867 - INFO - üöÄ Step 3740 | SFT: 0.4595 | Meta: 0.2905 | LR: 5.33e-06
2025-06-08 05:51:13,867 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 05:58:18,822 - INFO - 
============================================================
2025-06-08 05:58:18,822 - INFO - üìä VALIDATION 5/5 - Epoch 2, Step 3750
2025-06-08 05:58:18,822 - INFO - ============================================================
2025-06-08 05:58:18,822 - INFO -   ‚Ä¢ SFT Loss: 0.5770 (9000 samples)
2025-06-08 05:58:18,822 - INFO -   ‚Ä¢ Meta Loss: 0.3945 (1000 samples)
2025-06-08 05:58:18,822 - INFO -   ‚Ä¢ Average Loss: 0.5540
2025-06-08 05:58:18,822 - INFO -   ‚Ä¢ Meta-SFT Gap: -0.1825
2025-06-08 05:58:32,522 - INFO - ‚úÖ New best model saved in memory
2025-06-08 05:58:32,523 - INFO -   ‚Ä¢ Early Stop: SFT 0/3 | Meta 0/3
2025-06-08 05:58:32,523 - INFO -   ‚Ä¢ Best Avg: 0.5540 (epoch 1, step 3750)
2025-06-08 05:58:32,523 - INFO - ============================================================

2025-06-08 05:58:32,524 - INFO - üèÜ New best model! Saving...
2025-06-08 05:58:32,524 - INFO - üíæ Attempting to save model to: /root/llama3.2-3b-training/best/model
2025-06-08 05:58:32,524 - INFO -    Trying standard safe save...
2025-06-08 05:58:32,528 - WARNING -    Standard safe save failed: cannot import name 'DTensor' from 'torch.distributed.tensor' (/usr/local/lib/python3.11/dist-packages/torch/distributed/tensor/__init__.py)
2025-06-08 05:58:32,528 - INFO -    Trying without safe serialization...
2025-06-08 05:58:32,549 - WARNING -    Non-safe save failed: name 'DTensor' is not defined
2025-06-08 05:58:32,549 - INFO -    Trying manual state dict save...
2025-06-08 05:58:39,603 - INFO - ‚úÖ Manual save successful!
2025-06-08 05:59:00,611 - INFO - üíæ Checkpoint saved: /root/llama3.2-3b-training/checkpoints/checkpoint-best.pt
2025-06-08 05:59:00,613 - INFO - üöÄ Step 3750 | SFT: 0.4358 | Meta: 0.2993 | LR: 5.28e-06
2025-06-08 05:59:00,613 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 05:59:00,614 - INFO - üíæ Saving epoch 2 checkpoint...
2025-06-08 05:59:21,705 - INFO - üíæ Checkpoint saved: /root/llama3.2-3b-training/checkpoints/checkpoint-epoch-2.pt
2025-06-08 05:59:21,706 - INFO - üéØ EPOCH 2 COMPLETED
2025-06-08 05:59:21,706 - INFO -    Time: 321.2 min
2025-06-08 05:59:21,706 - INFO -    Processed batches: 11250
2025-06-08 05:59:21,706 - INFO -    Global steps: 3750
2025-06-08 05:59:21,706 - INFO - 
üéØ EPOCH 3/3
2025-06-08 06:00:56,875 - INFO - üöÄ Step 3760 | SFT: 0.2510 | Meta: 0.2806 | LR: 5.23e-06
2025-06-08 06:00:56,875 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 06:02:36,756 - INFO - üöÄ Step 3770 | SFT: 0.2738 | Meta: 0.2517 | LR: 5.18e-06
2025-06-08 06:02:36,757 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 06:04:11,111 - INFO - üöÄ Step 3780 | SFT: 0.2252 | Meta: 0.2262 | LR: 5.13e-06
2025-06-08 06:04:11,111 - INFO -    GPU: 35.9GB/79.3GB (45.4%)
2025-06-08 06:05:43,772 - INFO - üöÄ Step 3790 | SFT: 0.2630 | Meta: 0.2018 | LR: 5.08e-06
2025-06-08 06:05:43,772 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 06:07:15,163 - INFO - üöÄ Step 3800 | SFT: 0.2663 | Meta: 0.1813 | LR: 5.03e-06
2025-06-08 06:07:15,163 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 06:08:46,590 - INFO - üöÄ Step 3810 | SFT: 0.2454 | Meta: 0.1820 | LR: 4.98e-06
2025-06-08 06:08:46,591 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 06:10:20,523 - INFO - üöÄ Step 3820 | SFT: 0.2401 | Meta: 0.1752 | LR: 4.93e-06
2025-06-08 06:10:20,524 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 06:11:55,109 - INFO - üöÄ Step 3830 | SFT: 0.2829 | Meta: 0.1734 | LR: 4.88e-06
2025-06-08 06:11:55,109 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 06:13:24,580 - INFO - üöÄ Step 3840 | SFT: 0.2710 | Meta: 0.1702 | LR: 4.83e-06
2025-06-08 06:13:24,580 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 06:14:53,530 - INFO - üöÄ Step 3850 | SFT: 0.2628 | Meta: 0.1688 | LR: 4.78e-06
2025-06-08 06:14:53,530 - INFO -    GPU: 35.9GB/79.3GB (45.4%)
2025-06-08 06:16:29,040 - INFO - üöÄ Step 3860 | SFT: 0.2371 | Meta: 0.1684 | LR: 4.73e-06
2025-06-08 06:16:29,040 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 06:18:03,585 - INFO - üöÄ Step 3870 | SFT: 0.2575 | Meta: 0.1699 | LR: 4.68e-06
2025-06-08 06:18:03,585 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 06:19:41,327 - INFO - üöÄ Step 3880 | SFT: 0.2497 | Meta: 0.1751 | LR: 4.64e-06
2025-06-08 06:19:41,327 - INFO -    GPU: 35.9GB/79.3GB (45.4%)
2025-06-08 06:21:12,307 - INFO - üöÄ Step 3890 | SFT: 0.2491 | Meta: 0.1741 | LR: 4.59e-06
2025-06-08 06:21:12,307 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 06:22:49,719 - INFO - üöÄ Step 3900 | SFT: 0.2824 | Meta: 0.1752 | LR: 4.54e-06
2025-06-08 06:22:49,720 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 06:24:16,809 - INFO - üöÄ Step 3910 | SFT: 0.2408 | Meta: 0.1773 | LR: 4.49e-06
2025-06-08 06:24:16,809 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 06:25:47,890 - INFO - üöÄ Step 3920 | SFT: 0.2540 | Meta: 0.1765 | LR: 4.44e-06
2025-06-08 06:25:47,890 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 06:27:21,285 - INFO - üöÄ Step 3930 | SFT: 0.2668 | Meta: 0.1760 | LR: 4.40e-06
2025-06-08 06:27:21,285 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 06:28:55,616 - INFO - üöÄ Step 3940 | SFT: 0.2460 | Meta: 0.1768 | LR: 4.35e-06
2025-06-08 06:28:55,617 - INFO -    GPU: 35.9GB/79.3GB (45.4%)
2025-06-08 06:30:23,154 - INFO - üöÄ Step 3950 | SFT: 0.2821 | Meta: 0.1760 | LR: 4.30e-06
2025-06-08 06:30:23,155 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 06:31:58,323 - INFO - üöÄ Step 3960 | SFT: 0.2803 | Meta: 0.1777 | LR: 4.25e-06
2025-06-08 06:31:58,323 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 06:33:27,953 - INFO - üöÄ Step 3970 | SFT: 0.2695 | Meta: 0.1773 | LR: 4.21e-06
2025-06-08 06:33:27,954 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 06:35:01,891 - INFO - üöÄ Step 3980 | SFT: 0.2912 | Meta: 0.1728 | LR: 4.16e-06
2025-06-08 06:35:01,892 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 06:36:36,912 - INFO - üöÄ Step 3990 | SFT: 0.2535 | Meta: 0.1706 | LR: 4.11e-06
2025-06-08 06:36:36,912 - INFO -    GPU: 35.9GB/79.3GB (45.4%)
2025-06-08 06:38:08,722 - INFO - üöÄ Step 4000 | SFT: 0.2618 | Meta: 0.1723 | LR: 4.07e-06
2025-06-08 06:38:08,723 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 06:39:32,602 - INFO - üöÄ Step 4010 | SFT: 0.2649 | Meta: 0.1740 | LR: 4.02e-06
2025-06-08 06:39:32,603 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 06:40:56,934 - INFO - üöÄ Step 4020 | SFT: 0.2562 | Meta: 0.1752 | LR: 3.97e-06
2025-06-08 06:40:56,934 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 06:42:26,432 - INFO - üöÄ Step 4030 | SFT: 0.2701 | Meta: 0.1777 | LR: 3.93e-06
2025-06-08 06:42:26,432 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 06:44:02,722 - INFO - üöÄ Step 4040 | SFT: 0.2626 | Meta: 0.1781 | LR: 3.88e-06
2025-06-08 06:44:02,722 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 06:45:33,368 - INFO - üöÄ Step 4050 | SFT: 0.2494 | Meta: 0.1759 | LR: 3.84e-06
2025-06-08 06:45:33,369 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 06:46:56,567 - INFO - üöÄ Step 4060 | SFT: 0.2654 | Meta: 0.1758 | LR: 3.79e-06
2025-06-08 06:46:56,568 - INFO -    GPU: 35.9GB/79.3GB (45.4%)
2025-06-08 06:48:28,215 - INFO - üöÄ Step 4070 | SFT: 0.2595 | Meta: 0.1710 | LR: 3.75e-06
2025-06-08 06:48:28,216 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 06:49:57,294 - INFO - üöÄ Step 4080 | SFT: 0.2542 | Meta: 0.1702 | LR: 3.70e-06
2025-06-08 06:49:57,295 - INFO -    GPU: 35.9GB/79.3GB (45.4%)
2025-06-08 06:51:30,613 - INFO - üöÄ Step 4090 | SFT: 0.2628 | Meta: 0.1697 | LR: 3.66e-06
2025-06-08 06:51:30,613 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 06:53:04,475 - INFO - üöÄ Step 4100 | SFT: 0.2535 | Meta: 0.1685 | LR: 3.61e-06
2025-06-08 06:53:04,475 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 06:54:30,346 - INFO - üöÄ Step 4110 | SFT: 0.2478 | Meta: 0.1698 | LR: 3.57e-06
2025-06-08 06:54:30,346 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 06:55:54,267 - INFO - üöÄ Step 4120 | SFT: 0.2639 | Meta: 0.1697 | LR: 3.52e-06
2025-06-08 06:55:54,267 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 07:02:06,843 - INFO - 
============================================================
2025-06-08 07:02:06,844 - INFO - üìä VALIDATION 1/5 - Epoch 3, Step 4125
2025-06-08 07:02:06,844 - INFO - ============================================================
2025-06-08 07:02:06,844 - INFO -   ‚Ä¢ SFT Loss: 0.5976 (9000 samples)
2025-06-08 07:02:06,844 - INFO -   ‚Ä¢ Meta Loss: 0.4228 (1000 samples)
2025-06-08 07:02:06,844 - INFO -   ‚Ä¢ Average Loss: 0.5740
2025-06-08 07:02:06,844 - INFO -   ‚Ä¢ Meta-SFT Gap: -0.1748
2025-06-08 07:02:06,844 - INFO -   ‚Ä¢ Early Stop: SFT 1/3 | Meta 1/3
2025-06-08 07:02:06,844 - INFO -   ‚Ä¢ Best Avg: 0.5540 (epoch 1, step 3750)
2025-06-08 07:02:06,844 - INFO - ============================================================

2025-06-08 07:02:47,796 - INFO - üöÄ Step 4130 | SFT: 0.2864 | Meta: 0.1695 | LR: 3.48e-06
2025-06-08 07:02:47,797 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 07:04:20,632 - INFO - üöÄ Step 4140 | SFT: 0.2548 | Meta: 0.1677 | LR: 3.44e-06
2025-06-08 07:04:20,632 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 07:05:55,355 - INFO - üöÄ Step 4150 | SFT: 0.2352 | Meta: 0.1678 | LR: 3.39e-06
2025-06-08 07:05:55,355 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 07:07:16,878 - INFO - üöÄ Step 4160 | SFT: 0.2437 | Meta: 0.1723 | LR: 3.35e-06
2025-06-08 07:07:16,878 - INFO -    GPU: 35.9GB/79.3GB (45.4%)
2025-06-08 07:08:45,142 - INFO - üöÄ Step 4170 | SFT: 0.2648 | Meta: 0.1711 | LR: 3.31e-06
2025-06-08 07:08:45,142 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 07:10:17,187 - INFO - üöÄ Step 4180 | SFT: 0.2778 | Meta: 0.1711 | LR: 3.27e-06
2025-06-08 07:10:17,187 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 07:11:47,902 - INFO - üöÄ Step 4190 | SFT: 0.2617 | Meta: 0.1729 | LR: 3.22e-06
2025-06-08 07:11:47,903 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 07:13:19,931 - INFO - üöÄ Step 4200 | SFT: 0.2612 | Meta: 0.1750 | LR: 3.18e-06
2025-06-08 07:13:19,931 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 07:14:57,976 - INFO - üöÄ Step 4210 | SFT: 0.2449 | Meta: 0.1723 | LR: 3.14e-06
2025-06-08 07:14:57,976 - INFO -    GPU: 35.9GB/79.3GB (45.4%)
2025-06-08 07:16:23,494 - INFO - üöÄ Step 4220 | SFT: 0.2536 | Meta: 0.1737 | LR: 3.10e-06
2025-06-08 07:16:23,494 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 07:18:01,799 - INFO - üöÄ Step 4230 | SFT: 0.2684 | Meta: 0.1703 | LR: 3.06e-06
2025-06-08 07:18:01,799 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 07:19:32,785 - INFO - üöÄ Step 4240 | SFT: 0.2611 | Meta: 0.1683 | LR: 3.01e-06
2025-06-08 07:19:32,785 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 07:21:07,032 - INFO - üöÄ Step 4250 | SFT: 0.2668 | Meta: 0.1667 | LR: 2.97e-06
2025-06-08 07:21:07,033 - INFO -    GPU: 35.9GB/79.3GB (45.4%)
2025-06-08 07:22:43,188 - INFO - üöÄ Step 4260 | SFT: 0.2621 | Meta: 0.1661 | LR: 2.93e-06
2025-06-08 07:22:43,189 - INFO -    GPU: 35.9GB/79.3GB (45.4%)
2025-06-08 07:24:17,235 - INFO - üöÄ Step 4270 | SFT: 0.2394 | Meta: 0.1652 | LR: 2.89e-06
2025-06-08 07:24:17,236 - INFO -    GPU: 35.9GB/79.3GB (45.4%)
2025-06-08 07:25:52,539 - INFO - üöÄ Step 4280 | SFT: 0.2695 | Meta: 0.1682 | LR: 2.85e-06
2025-06-08 07:25:52,540 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 07:27:20,450 - INFO - üöÄ Step 4290 | SFT: 0.2505 | Meta: 0.1637 | LR: 2.81e-06
2025-06-08 07:27:20,450 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 07:28:59,008 - INFO - üöÄ Step 4300 | SFT: 0.2703 | Meta: 0.1640 | LR: 2.77e-06
2025-06-08 07:28:59,008 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 07:30:22,213 - INFO - üöÄ Step 4310 | SFT: 0.2752 | Meta: 0.1640 | LR: 2.73e-06
2025-06-08 07:30:22,213 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 07:32:01,175 - INFO - üöÄ Step 4320 | SFT: 0.2634 | Meta: 0.1612 | LR: 2.69e-06
2025-06-08 07:32:01,176 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 07:33:37,587 - INFO - üöÄ Step 4330 | SFT: 0.2672 | Meta: 0.1582 | LR: 2.65e-06
2025-06-08 07:33:37,587 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 07:35:17,237 - INFO - üöÄ Step 4340 | SFT: 0.2474 | Meta: 0.1625 | LR: 2.61e-06
2025-06-08 07:35:17,238 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 07:36:51,177 - INFO - üöÄ Step 4350 | SFT: 0.2712 | Meta: 0.1617 | LR: 2.58e-06
2025-06-08 07:36:51,177 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 07:38:24,576 - INFO - üöÄ Step 4360 | SFT: 0.2679 | Meta: 0.1626 | LR: 2.54e-06
2025-06-08 07:38:24,576 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 07:39:57,428 - INFO - üöÄ Step 4370 | SFT: 0.2605 | Meta: 0.1642 | LR: 2.50e-06
2025-06-08 07:39:57,429 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 07:41:31,322 - INFO - üöÄ Step 4380 | SFT: 0.2633 | Meta: 0.1657 | LR: 2.46e-06
2025-06-08 07:41:31,323 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 07:43:07,362 - INFO - üöÄ Step 4390 | SFT: 0.2769 | Meta: 0.1682 | LR: 2.42e-06
2025-06-08 07:43:07,363 - INFO -    GPU: 35.9GB/79.3GB (45.4%)
2025-06-08 07:44:56,928 - INFO - üöÄ Step 4400 | SFT: 0.2392 | Meta: 0.1697 | LR: 2.39e-06
2025-06-08 07:44:56,928 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 07:46:32,478 - INFO - üöÄ Step 4410 | SFT: 0.2431 | Meta: 0.1722 | LR: 2.35e-06
2025-06-08 07:46:32,478 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 07:48:01,691 - INFO - üöÄ Step 4420 | SFT: 0.2562 | Meta: 0.1706 | LR: 2.31e-06
2025-06-08 07:48:01,691 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 07:49:29,229 - INFO - üöÄ Step 4430 | SFT: 0.2609 | Meta: 0.1674 | LR: 2.27e-06
2025-06-08 07:49:29,229 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 07:51:01,509 - INFO - üöÄ Step 4440 | SFT: 0.2648 | Meta: 0.1648 | LR: 2.24e-06
2025-06-08 07:51:01,509 - INFO -    GPU: 35.9GB/79.3GB (45.4%)
2025-06-08 07:52:42,644 - INFO - üöÄ Step 4450 | SFT: 0.2607 | Meta: 0.1642 | LR: 2.20e-06
2025-06-08 07:52:42,645 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 07:54:17,730 - INFO - üöÄ Step 4460 | SFT: 0.2449 | Meta: 0.1637 | LR: 2.17e-06
2025-06-08 07:54:17,730 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 07:55:48,014 - INFO - üöÄ Step 4470 | SFT: 0.2718 | Meta: 0.1625 | LR: 2.13e-06
2025-06-08 07:55:48,014 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 07:57:10,696 - INFO - üöÄ Step 4480 | SFT: 0.2389 | Meta: 0.1632 | LR: 2.10e-06
2025-06-08 07:57:10,697 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 07:58:44,579 - INFO - üöÄ Step 4490 | SFT: 0.2586 | Meta: 0.1666 | LR: 2.06e-06
2025-06-08 07:58:44,579 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 08:05:50,005 - INFO - 
============================================================
2025-06-08 08:05:50,005 - INFO - üìä VALIDATION 2/5 - Epoch 3, Step 4500
2025-06-08 08:05:50,005 - INFO - ============================================================
2025-06-08 08:05:50,005 - INFO -   ‚Ä¢ SFT Loss: 0.5937 (9000 samples)
2025-06-08 08:05:50,005 - INFO -   ‚Ä¢ Meta Loss: 0.4182 (1000 samples)
2025-06-08 08:05:50,005 - INFO -   ‚Ä¢ Average Loss: 0.5696
2025-06-08 08:05:50,005 - INFO -   ‚Ä¢ Meta-SFT Gap: -0.1755
2025-06-08 08:05:50,005 - INFO -   ‚Ä¢ Early Stop: SFT 2/3 | Meta 2/3
2025-06-08 08:05:50,006 - INFO -   ‚Ä¢ Best Avg: 0.5540 (epoch 1, step 3750)
2025-06-08 08:05:50,006 - INFO - ============================================================

2025-06-08 08:05:50,006 - INFO - üöÄ Step 4500 | SFT: 0.2754 | Meta: 0.1675 | LR: 2.03e-06
2025-06-08 08:05:50,006 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 08:07:18,447 - INFO - üöÄ Step 4510 | SFT: 0.2688 | Meta: 0.1666 | LR: 1.99e-06
2025-06-08 08:07:18,447 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 08:08:52,832 - INFO - üöÄ Step 4520 | SFT: 0.2668 | Meta: 0.1653 | LR: 1.96e-06
2025-06-08 08:08:52,833 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 08:10:29,576 - INFO - üöÄ Step 4530 | SFT: 0.2445 | Meta: 0.1656 | LR: 1.92e-06
2025-06-08 08:10:29,576 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 08:12:12,245 - INFO - üöÄ Step 4540 | SFT: 0.2502 | Meta: 0.1662 | LR: 1.89e-06
2025-06-08 08:12:12,246 - INFO -    GPU: 35.9GB/79.3GB (45.4%)
2025-06-08 08:13:49,682 - INFO - üöÄ Step 4550 | SFT: 0.2582 | Meta: 0.1649 | LR: 1.85e-06
2025-06-08 08:13:49,682 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 08:15:18,087 - INFO - üöÄ Step 4560 | SFT: 0.2686 | Meta: 0.1644 | LR: 1.82e-06
2025-06-08 08:15:18,087 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 08:16:45,849 - INFO - üöÄ Step 4570 | SFT: 0.2716 | Meta: 0.1643 | LR: 1.79e-06
2025-06-08 08:16:45,849 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 08:18:22,857 - INFO - üöÄ Step 4580 | SFT: 0.2866 | Meta: 0.1657 | LR: 1.76e-06
2025-06-08 08:18:22,858 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 08:19:49,940 - INFO - üöÄ Step 4590 | SFT: 0.2446 | Meta: 0.1627 | LR: 1.72e-06
2025-06-08 08:19:49,941 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 08:20:27,318 - ERROR - Critical error in enhanced loss computation: CUDA out of memory. Tried to allocate 1.57 GiB. GPU 0 has a total capacity of 79.25 GiB of which 166.94 MiB is free. Process 3174301 has 79.08 GiB memory in use. Of the allocated memory 77.82 GiB is allocated by PyTorch, and 783.73 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-06-08 08:21:26,130 - INFO - üöÄ Step 4600 | SFT: 0.2979 | Meta: 0.1643 | LR: 1.69e-06
2025-06-08 08:21:26,130 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 08:22:58,040 - INFO - üöÄ Step 4610 | SFT: 0.2416 | Meta: 0.1659 | LR: 1.66e-06
2025-06-08 08:22:58,041 - INFO -    GPU: 35.9GB/79.3GB (45.4%)
2025-06-08 08:24:34,480 - INFO - üöÄ Step 4620 | SFT: 0.2411 | Meta: 0.1663 | LR: 1.63e-06
2025-06-08 08:24:34,480 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 08:26:00,978 - INFO - üöÄ Step 4630 | SFT: 0.2398 | Meta: 0.1656 | LR: 1.60e-06
2025-06-08 08:26:00,979 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 08:27:32,908 - INFO - üöÄ Step 4640 | SFT: 0.2563 | Meta: 0.1630 | LR: 1.57e-06
2025-06-08 08:27:32,909 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 08:29:02,511 - INFO - üöÄ Step 4650 | SFT: 0.2378 | Meta: 0.1619 | LR: 1.53e-06
2025-06-08 08:29:02,512 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 08:30:36,244 - INFO - üöÄ Step 4660 | SFT: 0.2745 | Meta: 0.1644 | LR: 1.50e-06
2025-06-08 08:30:36,245 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 08:32:07,161 - INFO - üöÄ Step 4670 | SFT: 0.2513 | Meta: 0.1637 | LR: 1.47e-06
2025-06-08 08:32:07,161 - INFO -    GPU: 35.9GB/79.3GB (45.4%)
2025-06-08 08:33:36,260 - INFO - üöÄ Step 4680 | SFT: 0.2629 | Meta: 0.1657 | LR: 1.44e-06
2025-06-08 08:33:36,260 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 08:35:07,721 - INFO - üöÄ Step 4690 | SFT: 0.2409 | Meta: 0.1676 | LR: 1.41e-06
2025-06-08 08:35:07,722 - INFO -    GPU: 35.9GB/79.3GB (45.4%)
2025-06-08 08:36:40,961 - INFO - üöÄ Step 4700 | SFT: 0.2728 | Meta: 0.1715 | LR: 1.38e-06
2025-06-08 08:36:40,961 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 08:38:09,023 - INFO - üöÄ Step 4710 | SFT: 0.2463 | Meta: 0.1678 | LR: 1.36e-06
2025-06-08 08:38:09,023 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 08:39:38,273 - INFO - üöÄ Step 4720 | SFT: 0.2414 | Meta: 0.1669 | LR: 1.33e-06
2025-06-08 08:39:38,273 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 08:41:08,130 - INFO - üöÄ Step 4730 | SFT: 0.2475 | Meta: 0.1651 | LR: 1.30e-06
2025-06-08 08:41:08,131 - INFO -    GPU: 35.9GB/79.3GB (45.4%)
2025-06-08 08:42:47,492 - INFO - üöÄ Step 4740 | SFT: 0.2689 | Meta: 0.1649 | LR: 1.27e-06
2025-06-08 08:42:47,493 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 08:44:13,434 - INFO - üöÄ Step 4750 | SFT: 0.2554 | Meta: 0.1643 | LR: 1.24e-06
2025-06-08 08:44:13,434 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 08:45:44,444 - INFO - üöÄ Step 4760 | SFT: 0.2660 | Meta: 0.1647 | LR: 1.21e-06
2025-06-08 08:45:44,444 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 08:47:09,247 - INFO - üöÄ Step 4770 | SFT: 0.2327 | Meta: 0.1652 | LR: 1.19e-06
2025-06-08 08:47:09,247 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 08:48:41,008 - INFO - üöÄ Step 4780 | SFT: 0.2767 | Meta: 0.1653 | LR: 1.16e-06
2025-06-08 08:48:41,008 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 08:50:19,178 - INFO - üöÄ Step 4790 | SFT: 0.2567 | Meta: 0.1669 | LR: 1.13e-06
2025-06-08 08:50:19,178 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 08:51:59,948 - INFO - üöÄ Step 4800 | SFT: 0.2322 | Meta: 0.1644 | LR: 1.11e-06
2025-06-08 08:51:59,948 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 08:53:44,068 - INFO - üöÄ Step 4810 | SFT: 0.2504 | Meta: 0.1643 | LR: 1.08e-06
2025-06-08 08:53:44,069 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 08:55:14,429 - INFO - üöÄ Step 4820 | SFT: 0.2519 | Meta: 0.1608 | LR: 1.05e-06
2025-06-08 08:55:14,429 - INFO -    GPU: 35.9GB/79.3GB (45.4%)
2025-06-08 08:56:48,545 - INFO - üöÄ Step 4830 | SFT: 0.2645 | Meta: 0.1580 | LR: 1.03e-06
2025-06-08 08:56:48,545 - INFO -    GPU: 35.9GB/79.3GB (45.4%)
2025-06-08 08:58:18,535 - INFO - üöÄ Step 4840 | SFT: 0.2613 | Meta: 0.1584 | LR: 1.00e-06
2025-06-08 08:58:18,536 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 08:59:57,120 - INFO - üöÄ Step 4850 | SFT: 0.2458 | Meta: 0.1606 | LR: 9.79e-07
2025-06-08 08:59:57,121 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 09:01:34,649 - INFO - üöÄ Step 4860 | SFT: 0.2560 | Meta: 0.1612 | LR: 9.54e-07
2025-06-08 09:01:34,649 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 09:02:56,931 - INFO - üöÄ Step 4870 | SFT: 0.2579 | Meta: 0.1621 | LR: 9.30e-07
2025-06-08 09:02:56,931 - INFO -    GPU: 35.9GB/79.3GB (45.3%)
2025-06-08 09:09:14,382 - INFO - 
============================================================
2025-06-08 09:09:14,383 - INFO - üìä VALIDATION 3/5 - Epoch 3, Step 4875
2025-06-08 09:09:14,383 - INFO - ============================================================
2025-06-08 09:09:14,383 - INFO -   ‚Ä¢ SFT Loss: 0.5899 (9000 samples)
2025-06-08 09:09:14,383 - INFO -   ‚Ä¢ Meta Loss: 0.4131 (1000 samples)
2025-06-08 09:09:14,383 - INFO -   ‚Ä¢ Average Loss: 0.5653
2025-06-08 09:09:14,383 - INFO -   ‚Ä¢ Meta-SFT Gap: -0.1769
2025-06-08 09:09:14,383 - INFO -   ‚Ä¢ Early Stop: SFT 3/3 | Meta 3/3
2025-06-08 09:09:14,383 - INFO -   ‚Ä¢ Best Avg: 0.5540 (epoch 1, step 3750)
2025-06-08 09:09:14,383 - INFO - ============================================================

2025-06-08 09:09:14,383 - INFO - üõë Early stopping triggered!
2025-06-08 09:09:14,383 - INFO -    Both SFT and Meta losses stopped improving for 3 evaluations
2025-06-08 09:09:14,383 - INFO - üíæ Attempting to save model to: /root/llama3.2-3b-training/final/model
2025-06-08 09:09:14,383 - INFO -    Trying standard safe save...
2025-06-08 09:09:14,387 - WARNING -    Standard safe save failed: cannot import name 'DTensor' from 'torch.distributed.tensor' (/usr/local/lib/python3.11/dist-packages/torch/distributed/tensor/__init__.py)
2025-06-08 09:09:14,387 - INFO -    Trying without safe serialization...
2025-06-08 09:09:14,408 - WARNING -    Non-safe save failed: name 'DTensor' is not defined
2025-06-08 09:09:14,408 - INFO -    Trying manual state dict save...
2025-06-08 09:09:21,583 - INFO - ‚úÖ Manual save successful!
2025-06-08 09:09:36,127 - ERROR - Training failed: [enforce fail at inline_container.cc:603] . unexpected pos 16468764480 vs 16468764376
2025-06-08 09:09:36,129 - ERROR - üîç Debug Information:
2025-06-08 09:09:36,129 - ERROR -    ‚Ä¢ Current directory: /root
2025-06-08 09:09:36,129 - ERROR -    ‚Ä¢ Dataset exists: True
2025-06-08 09:09:36,129 - ERROR -    ‚Ä¢ GPU: NVIDIA A100-SXM4-80GB
2025-06-08 09:09:36,129 - ERROR -    ‚Ä¢ VRAM: 79.3 GB
